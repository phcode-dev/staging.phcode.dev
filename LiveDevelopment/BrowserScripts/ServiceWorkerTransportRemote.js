!function(global){function _debugLog(...args){window.LIVE_PREVIEW_DEBUG_ENABLED&&console.log(...args)}const clientID=""+Math.round(1e9*Math.random()),LIVE_PREVIEW_NAVIGATOR_CHANNEL_ID=`${window.PHOENIX_INSTANCE_ID}-nav-live-preview`,worker=new Worker(window.LIVE_DEV_REMOTE_WORKER_SCRIPTS_FILE_NAME);worker.onmessage=(event=>{const type=event.data.type;switch(type){case"REDIRECT_CONTENT_FRAME":document.getElementById("contentFrame").src=event.data.URL;break;case"REDIRECT_PAGE":location.href=event.data.URL;break;default:console.error("Live Preview page loader: received unknown message from worker:",event)}}),worker.postMessage({type:"setupBroadcast",broadcastChannel:LIVE_PREVIEW_NAVIGATOR_CHANNEL_ID,clientID:clientID});const WebSocketTransport={_channelOpen:!1,_broadcastMessageChannel:null,_callbacks:null,setCallbacks:function(callbacks){this._callbacks=callbacks},connect:function(){const self=this;self._broadcastMessageChannel=new BroadcastChannel(window.LIVE_PREVIEW_BROADCAST_CHANNEL_ID),self._broadcastMessageChannel.postMessage({type:"BROWSER_CONNECT",url:global.location.href,clientID:clientID}),self._broadcastMessageChannel.onmessage=(event=>{_debugLog("Live Preview: Browser received event from Phoenix: ",JSON.stringify(event.data));const type=event.data.type;switch(type){case"BROWSER_CONNECT":case"BROWSER_MESSAGE":case"BROWSER_CLOSE":break;case"MESSAGE_FROM_PHOENIX":if(self._callbacks&&self._callbacks.message){const clientIDs=event.data.clientIDs,message=event.data.message;(clientIDs.includes(clientID)||0===clientIDs.length)&&self._callbacks.message(message)}break;case"PHOENIX_CLOSE":self._channelOpen=!1,self._broadcastMessageChannel.close(),self._callbacks&&self._callbacks.close&&self._callbacks.close();break;default:console.error("Unknown event type for event",event)}}),self._channelOpen=!0,self._callbacks&&self._callbacks.connect&&self._callbacks.connect(),addEventListener("beforeunload",function(){self._channelOpen&&(self._channelOpen=!1,self._broadcastMessageChannel.postMessage({type:"BROWSER_CLOSE",clientID:clientID}))})},send:function(msgStr){const self=this;this._broadcastMessageChannel.postMessage({type:"BROWSER_MESSAGE",clientID:clientID,message:msgStr})},enable:function(){this.connect()}};global._Brackets_LiveDev_Transport=WebSocketTransport}(this);
//# sourceMappingURL=ServiceWorkerTransportRemote.js.map
