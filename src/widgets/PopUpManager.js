define(function(require,exports,module){var AppInit=require("utils/AppInit"),EventDispatcher=require("utils/EventDispatcher"),CommandManager=require("command/CommandManager"),KeyEvent=require("utils/KeyEvent"),_popUps=[];function addPopUp($popUp,removeHandler,autoRemove){autoRemove=autoRemove||!1,_popUps.push($popUp[0]),$popUp.data("PopUpManager-autoRemove",autoRemove),$popUp.data("PopUpManager-removeHandler",removeHandler)}function removePopUp($popUp){if($popUp.find(":visible").length>0){var removeHandler=$popUp.data("PopUpManager-removeHandler");removeHandler&&removeHandler()}var index=_popUps.indexOf($popUp[0]),autoRemove;index>=0&&($popUp.data("PopUpManager-autoRemove")&&($popUp.remove(),_popUps.splice(index,1)))}function removeCurrentPopUp(keyEvent){var $popUp,i,event=new $.Event("popUpClose");for(i=_popUps.length-1;i>=0;i--)if(($popUp=$(_popUps[i])).find(":visible").length>0){$popUp.trigger(event),event.isDefaultPrevented()||(keyEvent&&keyEvent.stopImmediatePropagation(),removePopUp($popUp));break}}function _keydownCaptureListener(keyEvent){(keyEvent.keyCode===KeyEvent.DOM_VK_ESCAPE||keyEvent.keyCode===KeyEvent.DOM_VK_ALT&&"win"===brackets.platform)&&(keyEvent.keyCode===KeyEvent.DOM_VK_ALT&&keyEvent.ctrlKey||removeCurrentPopUp(keyEvent))}function _beforeMenuPopup(){removeCurrentPopUp()}function listenToContextMenu(contextMenu){contextMenu.on("beforeContextMenuOpen",_beforeMenuPopup)}AppInit.htmlReady(function(){window.document.body.addEventListener("keydown",_keydownCaptureListener,!0),exports.on("beforeMenuPopup",_beforeMenuPopup),CommandManager.on("beforeExecuteCommand",function(event,commandId){removeCurrentPopUp()})}),EventDispatcher.makeEventDispatcher(exports),exports.addPopUp=addPopUp,exports.removePopUp=removePopUp,exports.listenToContextMenu=listenToContextMenu});
//# sourceMappingURL=PopUpManager.js.map
