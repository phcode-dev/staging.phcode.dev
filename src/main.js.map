{"version":3,"sources":["main.js"],"names":["require","config","paths","text","i18n","fileSystemImpl","preact-compat","preact","map","*","thirdparty/CodeMirror2","thirdparty/preact","view/PanelManager","waitSeconds","window","location","search","indexOf","preferences/PreferencesImpl","locale","localStorage","getItem","navigator","language","jsPromise","jqueryOrJSPromise","catch","then","finally","fail","done","console","error","Error","Promise","resolve","reject","trackedScriptCount","_setSplashScreenStatusUpdate","message","splashScreenFrame","document","getElementById","displayBtn","contentDocument","textContent","debugMode","scriptObserver","disconnect","log","callback","mutationsList","mutation","type","addedNodes","length","src","scriptAddedSplit","split","mainScripts","childList","MutationObserver","observe","onerror","msg","url","line","err","define","e","reload"],"mappings":"AAyBAA,QAAQC,OAAO,CACXC,MAAO,CACHC,KAAQ,uBACRC,KAAQ,uBAIRC,eAAkB,+CAClBC,gBAAiB,6CACjBC,OAAU,4BAEdC,IAAK,CACDC,IAAK,CACDC,yBAA0B,wBAC1BC,oBAAqB,gBACrBC,oBAAqB,0BAG7BC,YAAa,KAGbC,OAAOC,SAASC,OAAOC,QAAQ,oBAAsB,EACrDjB,QAAQC,OAAO,CACXC,MAAO,CACHgB,8BAA+B,+BAEnCC,OAAQ,OAWZnB,QAAQC,OAAO,CACXkB,OAAQL,OAAOM,aAAaC,QAAQ,WAAaP,OAAOQ,UAAUC,WAU1ET,OAAOU,UAAY,SAAUC,mBACzB,GAAGA,mBAAqBA,kBAAkBC,OAASD,kBAAkBE,MAAQF,kBAAkBG,QAE3F,OAAQH,kBAEZ,IAAIA,mBACCA,oBAAsBA,kBAAkBI,MAAUJ,oBAAsBA,kBAAkBK,KAE3F,MADAC,QAAQC,MAAM,sEACR,IAAIC,MAAM,sEAEpB,OAAO,IAAIC,QAAQ,CAACC,QAASC,UACzBX,kBACKK,KAAKK,SACLN,KAAKO,WAKlB,IAAIC,mBAAqB,EACzB,SAASC,6BAA6BC,SAClC,IAAIC,kBAAoBC,SAASC,eAAe,uBAU5CC,WATJ,OAAIH,mBASaA,kBAAkBI,gBAAgBF,eAAe,2BACvDG,YAAcN,SAClB,IAVCzB,OAAOgC,YAGPhC,OAAOiC,eAAeC,aACtBjB,QAAQkB,IAAI,wDAET,GAQf,MAAMC,SAAW,SAASC,eACtB,IAAI,MAAMC,YAAYD,cAClB,GAAsB,cAAlBC,SAASC,MAAwBD,SAASE,WAAWC,OAAQ,GAAKH,SAASE,WAAW,GAAGE,IAAK,CAC9FnB,qBACA,IAAIoB,iBAAmBL,SAASE,WAAW,GAAGE,IAAIE,MAAM,KACrDD,iBAAiBF,OAAS,GACzBjB,yCACgBD,uBAAuBoB,iBAAiBA,iBAAiBF,OAAO,QAK1FI,YAAclB,SAASC,eAAe,qBACtCzC,OAAS,CAAE2D,WAAW,GAE5B9C,OAAOiC,eAAiB,IAAIc,iBAAiBX,UAG7CpC,OAAOiC,eAAee,QAAQH,YAAa1D,QAE3Ca,OAAOiD,QAAU,SAAUC,IAAKC,IAAKC,QAASC,KAG1C,OAFApC,QAAQC,MAAM,+BACRiC,IAAM,IAAMC,KAAO,aAAeF,OAAQG,MACzC,GAGXC,OAAO,SAAUpE,SAIbA,QAAQ,CAAC,uBAAwB,WAE7B,IACIA,QAAQ,CAAC,aACX,MAAOqE,GACLtC,QAAQC,MAAM,iEACdlB,OAAOC,SAASuD","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2013 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/**\n * The bootstrapping module for brackets. This module sets up the require\n * configuration and loads the brackets module.\n */\nrequire.config({\n    paths: {\n        \"text\": \"thirdparty/text/text\",\n        \"i18n\": \"thirdparty/i18n/i18n\",\n\n        // The file system implementation. Change this value to use different\n        // implementations (e.g. cloud-based storage).\n        \"fileSystemImpl\": \"filesystem/impls/appshell/AppshellFileSystem\",\n        \"preact-compat\": \"thirdparty/preact-compat/preact-compat.min\",\n        \"preact\": \"thirdparty/preact/preact\"\n    },\n    map: {\n        \"*\": {\n            \"thirdparty/CodeMirror2\": \"thirdparty/CodeMirror\",\n            \"thirdparty/preact\": \"preact-compat\",\n            \"view/PanelManager\": \"view/WorkspaceManager\"  // For extension compatibility\n        }\n    },\n    waitSeconds: 60\n});\n\nif (window.location.search.indexOf(\"testEnvironment\") > -1) {\n    require.config({\n        paths: {\n            \"preferences/PreferencesImpl\": \"../test/TestPreferencesImpl\"\n        },\n        locale: \"en\" // force English (US)\n    });\n} else {\n    /**\n     * hack for r.js optimization, move locale to another config call\n     *\n     * Use custom brackets property until CEF sets the correct navigator.language\n     * NOTE: When we change to navigator.language here, we also should change to\n     * navigator.language in ExtensionLoader (when making require contexts for each\n     * extension).\n     */\n    require.config({\n        locale: window.localStorage.getItem(\"locale\") || window.navigator.language\n    });\n}\n\n/**\n * global util to convert jquery/js promise to a js promise. This can be used as an adapter when you do not know if the\n * promise in hand is a js or jquery deferred promise. This function will always return a normal js promise.\n * @param jqueryOrJSPromise\n * @returns {{finally}|{then}|{catch}|*}\n */\nwindow.jsPromise = function (jqueryOrJSPromise) {\n    if(jqueryOrJSPromise && jqueryOrJSPromise.catch && jqueryOrJSPromise.then && jqueryOrJSPromise.finally){\n        // this should be a normal js promise return as is\n        return  jqueryOrJSPromise;\n    }\n    if(!jqueryOrJSPromise ||\n        (jqueryOrJSPromise && !jqueryOrJSPromise.fail) || (jqueryOrJSPromise && !jqueryOrJSPromise.done)){\n        console.error(\"this function expects a jquery promise with done and fail handlers\");\n        throw new Error(\"this function expects a jquery promise with done and fail handlers\");\n    }\n    return new Promise((resolve, reject)=>{\n        jqueryOrJSPromise\n            .done(resolve)\n            .fail(reject);\n    });\n};\n\n// splash screen updates for initial install which could take time, or slow networks.\nlet trackedScriptCount = 0;\nfunction _setSplashScreenStatusUpdate(message) {\n    let splashScreenFrame = document.getElementById(\"splash-screen-frame\");\n    if(!splashScreenFrame){\n        if(!window.debugMode){\n            // If not in debug mode & splash screen isn't there, we don't need to observe dom script update status\n            // to improve performance.\n            window.scriptObserver.disconnect();\n            console.log('startup Watcher: Disconnected script load watcher.');\n        }\n        return false;\n    }\n    let displayBtn = splashScreenFrame.contentDocument.getElementById(\"load-status-display-btn\");\n    displayBtn.textContent = message;\n    return true;\n}\n\n// Callback function to execute when mutations are observed\nconst callback = function(mutationsList) {\n    for(const mutation of mutationsList) {\n        if (mutation.type === 'childList' && mutation.addedNodes.length >0 && mutation.addedNodes[0].src) {\n            trackedScriptCount++;\n            let scriptAddedSplit = mutation.addedNodes[0].src.split(\"/\");\n            if(scriptAddedSplit.length > 0){\n                _setSplashScreenStatusUpdate(\n                    `Loading (${trackedScriptCount}) ${scriptAddedSplit[scriptAddedSplit.length-1]}`);\n            }\n        }\n    }\n};\nconst mainScripts = document.getElementById('main-scripts-head');\nconst config = { childList: true};\n// Create an observer instance linked to the callback function\nwindow.scriptObserver = new MutationObserver(callback);\n\n// Start observing the target node for configured mutations\nwindow.scriptObserver.observe(mainScripts, config);\n\nwindow.onerror = function (msg, url, line, ...err) {\n    console.error(\"Caught Critical error from: \"\n        + url + \":\" + line + \" message: \" + msg, ...err);\n    return true; // same as preventDefault\n};\n\ndefine(function (require) {\n\n\n    // Load compatibility shims--these need to load early, be careful moving this\n    require([\"utils/Compatibility\"], function () {\n        // Load the brackets module. This is a self-running module that loads and runs the entire application.\n        try{\n            require([\"brackets\"]);\n        } catch (e) {\n            console.error('Critical error when loading brackets. Trying to reload again.');\n            window.location.reload();\n        }\n    });\n});\n"],"file":"main.js"}