{"version":3,"sources":["LiveDevelopment/BrowserScripts/RemoteFunctions.js"],"names":["RemoteFunctions","config","remoteWSPort","experimental","req","timeout","animateHighlight","time","window","cancelAnimationFrame","clearTimeout","requestAnimationFrame","redrawHighlights","setTimeout","_editHandler","HIGHLIGHT_CLASSNAME","_currentEditor","_currentMenu","_localHighlight","_remoteHighlight","_validEvent","event","navigator","platform","substr","metaKey","ctrlKey","_typeColor","type","highlight","_screenOffset","element","elemBounds","getBoundingClientRect","body","document","offsetTop","offsetLeft","getComputedStyle","position","left","pageXOffset","top","pageYOffset","bodyBounds","_trigger","name","value","autoRemove","key","setAttribute","removeAttribute","bind","isInViewport","rect","html","documentElement","bottom","innerHeight","clientHeight","right","innerWidth","clientWidth","getDocumentOffsetTop","offsetParent","Menu","this","remoteShowGoto","remove","Editor","onBlur","onKeyPress","focus","addEventListener","revertText","innerHTML","Highlight","color","trigger","elements","selector","_toggleEditor","_toggleMenu","prototype","onClick","url","preventDefault","createBody","offset","x","y","offsetHeight","createElement","style","setProperty","addItem","target","item","childNodes","length","file","appendChild","show","parentNode","removeChild","removeEventListener","which","blur","_elementExists","i","_makeHighlightDiv","doAnimation","elementBounds","elementStyling","transitionDuration","parseFloat","getPropertyValue","animationDuration","trackingElement","width","height","realElBorder","borderBox","boxSizing","outerHeight","outerWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","visualisations","horizontal","vertical","drawPaddingRect","side","elStyling","indexOf","drawMarginRect","margin","setVisibility","el","remoteHighlight","showPaddingMargin","parseInt","display","mainBoxStyles","stylesToSet","paddingVisualisations","marginVisualisations","setupVisualisations","arr","styles","_setStyleValues","Object","assign","marginStyling","paddingStyling","className","z-index","padding","pointer-events","box-shadow","box-sizing","border-right","border-left","border-top","border-bottom","border-color","borderColor","mergedStyles","animateStartValues","animateStartValue","animateEndValues","animateEndValue","transitionValues","transition-property","transition-duration","styleValues","obj","prop","add","MessageEvent","scrollTo","push","clear","highlights","querySelectorAll","redraw","highlighted","slice","_setup","onMouseOver","onMouseOut","onMouseMove","stopPropagation","altKey","onKeyUp","undefined","onKeyDown","showGoto","targets","hideHighlight","node","highlightRule","rule","nodes","_scrollHandler","e","DOMEditHandler","htmlDocument","rememberedNodes","entityParseParent","_isRawTextNode","nodeType","Node","ELEMENT_NODE","test","tagName","applyDOMEdits","edits","apply","_domElementToJSON","elem","json","tag","toLowerCase","attributes","children","len","TEXT_NODE","content","nodeValue","getSimpleDOM","JSON","stringify","updateConfig","newConfig","parse","_queryBracketsID","id","results","_insertChildNode","targetElement","childElement","edit","before","beforeID","after","afterID","firstChild","lastChild","insertBefore","nextSibling","_parseEntities","text","result","textContent","_textReplace","prevIgnoringHighlights","previousSibling","nextIgnoringHighlights","lastChildIgnoringHighlights","start","startMissing","end","endMissing","moveNext","current","next","textNode","createTextNode","lastRemovedWasText","isText","targetID","self","forEach","editIsSpecialTag","match","parentID","tagID","attribute","keys","attr","textElement","console","error","tagIDs","_ws","onDocumentClick","currentDataId","newDataId","hasAttribute","send","message","getAttribute","createWebSocket","WebSocket","onopen","onmessage","evt","onclose"],"mappings":"AA8BA,SAASA,gBAAgBC,OAAQC,cAG7B,IAAIC,aAMAC,IAAKC,QAFLF,eAHCF,QAGcA,OAAOE,aAG1B,IAAIG,iBAAmB,SAAUC,MAC1BH,MACCI,OAAOC,qBAAqBL,KAC5BI,OAAOE,aAAaL,UAExBD,IAAMI,OAAOG,sBAAsBC,kBAEnCP,QAAUQ,WAAW,WACjBL,OAAOC,qBAAqBL,KAC5BA,IAAM,MACA,IAAPG,OAMHO,aAEAC,oBAAsB,0BA4etBC,eAKAC,aAQAC,gBACAC,iBAvfJ,SAASC,YAAYC,OACjB,MAA+C,QAA3Cb,OAAOc,UAAUC,SAASC,OAAO,EAAG,GAE7BH,MAAMI,QAGNJ,MAAMK,QAKrB,SAASC,WAAWC,KAAMC,WACtB,OAAQD,MACR,IAAK,OACD,OAAOC,UAAY,OAAS,OAChC,IAAK,MACD,OAAOA,UAAY,OAAS,OAChC,IAAK,KACD,OAAOA,UAAY,OAAS,OAChC,QACI,OAAOA,UAAY,OAAS,QAKpC,SAASC,cAAcC,SACnB,IAAIC,WAAaD,QAAQE,wBACrBC,KAAO1B,OAAO2B,SAASD,KACvBE,UACAC,WAEJ,GAA+C,WAA3C7B,OAAO8B,iBAAiBJ,MAAMK,SAC9BF,WAAaL,WAAWQ,KAAOhC,OAAOiC,YACtCL,UAAYJ,WAAWU,IAAMlC,OAAOmC,gBACjC,CACH,IAAIC,WAAaV,KAAKD,wBACtBI,WAAaL,WAAWQ,KAAOI,WAAWJ,KAC1CJ,UAAYJ,WAAWU,IAAME,WAAWF,IAE5C,MAAO,CAAEF,KAAMH,WAAYK,IAAKN,WAIpC,SAASS,SAASd,QAASe,KAAMC,MAAOC,YACpC,IAAIC,IAAM,WAAaH,KACnBC,MAAAA,OACAhB,QAAQmB,aAAaD,IAAKF,OACtBC,YACAxC,OAAOK,WAAWkB,QAAQoB,gBAAgBC,KAAKrB,QAASkB,OAG5DlB,QAAQoB,gBAAgBF,KAKhC,SAASI,aAAatB,SAClB,IAAIuB,KAAOvB,QAAQE,wBACfsB,KAAO/C,OAAO2B,SAASqB,gBAC3B,OACIF,KAAKZ,KAAO,GACZY,KAAKd,MAAQ,GACbc,KAAKG,SAAWjD,OAAOkD,aAAeH,KAAKI,eAC3CL,KAAKM,QAAUpD,OAAOqD,YAAcN,KAAKO,aAKjD,SAASC,qBAAqBhC,SAC1B,OAAOA,QAAQK,WAAaL,QAAQiC,aAAeD,qBAAqBhC,QAAQiC,cAAgB,GAIpG,SAASC,KAAKlC,SACVmC,KAAKnC,QAAUA,QACfc,SAASqB,KAAKnC,QAAS,WAAY,GAAG,GACtCvB,OAAOK,WAAWL,OAAO2D,gBACzBD,KAAKE,OAASF,KAAKE,OAAOhB,KAAKc,MA4EnC,SAASG,OAAOtC,SACZmC,KAAKI,OAASJ,KAAKI,OAAOlB,KAAKc,MAC/BA,KAAKK,WAAaL,KAAKK,WAAWnB,KAAKc,MAEvCA,KAAKnC,QAAUA,QACfmC,KAAKnC,QAAQmB,aAAa,kBAAmB,QAC7CgB,KAAKnC,QAAQyC,QACbN,KAAKnC,QAAQ0C,iBAAiB,OAAQP,KAAKI,QAC3CJ,KAAKnC,QAAQ0C,iBAAiB,WAAYP,KAAKK,YAE/CL,KAAKQ,WAAaR,KAAKnC,QAAQ4C,UAE/B9B,SAASqB,KAAKnC,QAAS,OAAQ,GAwBnC,SAAS6C,UAAUC,MAAOC,SACtBZ,KAAKW,MAAQA,MACbX,KAAKY,UAAYA,QACjBZ,KAAKa,SAAW,GAChBb,KAAKc,SAAW,GAySpB,SAASC,cAAclD,SACnBf,eAAiB,IAAIqD,OAAOtC,SAIhC,SAASmD,YAAYnD,SACbd,cACAA,aAAamD,SAEjBnD,aAAe,IAAIgD,KAAKlC,SAna5BkC,KAAKkB,UAAY,CACbC,QAAS,SAAUC,IAAKhE,OACpBA,MAAMiE,iBACNzC,SAASqB,KAAKnC,QAAS,OAAQsD,KAAK,GACpCnB,KAAKE,UAGTmB,WAAY,WACR,IAAIrB,KAAKhC,KAAT,CAKA,IAAIsD,OAAS1D,cAAcoC,KAAKnC,SAC5B0D,EAAID,OAAOhD,KACXkD,EAAIF,OAAO9C,IAAMwB,KAAKnC,QAAQ4D,aAGlCzB,KAAKhC,KAAO1B,OAAO2B,SAASyD,cAAc,OAC1C1B,KAAKhC,KAAK2D,MAAMC,YAAY,UAAW,YACvC5B,KAAKhC,KAAK2D,MAAMC,YAAY,WAAY,YACxC5B,KAAKhC,KAAK2D,MAAMC,YAAY,OAAQL,EAAI,MACxCvB,KAAKhC,KAAK2D,MAAMC,YAAY,MAAOJ,EAAI,MACvCxB,KAAKhC,KAAK2D,MAAMC,YAAY,YAAa,QAGzC5B,KAAKhC,KAAK2D,MAAMC,YAAY,aAAc,QAC1C5B,KAAKhC,KAAK2D,MAAMC,YAAY,SAAU,kBACtC5B,KAAKhC,KAAK2D,MAAMC,YAAY,qBAAsB,wBAClD5B,KAAKhC,KAAK2D,MAAMC,YAAY,gBAAiB,OAC7C5B,KAAKhC,KAAK2D,MAAMC,YAAY,UAAW,SAG3CC,QAAS,SAAUC,QACf,IAAIC,KAAOzF,OAAO2B,SAASyD,cAAc,OAUzC,GATAK,KAAKJ,MAAMC,YAAY,UAAW,WAC9B5B,KAAKhC,KAAKgE,WAAWC,OAAS,GAC9BF,KAAKJ,MAAMC,YAAY,aAAc,kBAEzCG,KAAKJ,MAAMC,YAAY,SAAU,WACjCG,KAAKJ,MAAMC,YAAY,aAAcnE,WAAWqE,OAAOpE,OACvDqE,KAAKtB,UAAYqB,OAAOlD,KACxBmD,KAAKxB,iBAAiB,QAASP,KAAKkB,QAAQhC,KAAKc,KAAM8B,OAAOX,MAE1DW,OAAOI,KAAM,CACb,IAAIA,KAAO5F,OAAO2B,SAASyD,cAAc,KACzCQ,KAAKP,MAAMC,YAAY,QAAS,SAChCM,KAAKP,MAAMC,YAAY,cAAe,QACtCM,KAAKzB,UAAY,IAAMqB,OAAOI,KAC9BH,KAAKI,YAAYD,MAErBlC,KAAKhC,KAAKmE,YAAYJ,OAG1BK,KAAM,WACGpC,KAAKhC,OACNgC,KAAKhC,KAAOgC,KAAKqB,cAEhBrB,KAAKhC,KAAKqE,YACX/F,OAAO2B,SAASD,KAAKmE,YAAYnC,KAAKhC,MAE1C1B,OAAO2B,SAASsC,iBAAiB,QAASP,KAAKE,SAGnDA,OAAQ,WACAF,KAAKhC,MAAQgC,KAAKhC,KAAKqE,YACvB/F,OAAO2B,SAASD,KAAKsE,YAAYtC,KAAKhC,MAE1C1B,OAAO2B,SAASsE,oBAAoB,QAASvC,KAAKE,UAoB1DC,OAAOc,UAAY,CACfb,OAAQ,SAAUjD,OACd6C,KAAKnC,QAAQoB,gBAAgB,mBAC7Be,KAAKnC,QAAQ0E,oBAAoB,OAAQvC,KAAKI,QAC9CJ,KAAKnC,QAAQ0E,oBAAoB,WAAYvC,KAAKK,YAClD1B,SAASqB,KAAKnC,QAAS,OAAQ,GAAG,IAGtCwC,WAAY,SAAUlD,OAClB,OAAQA,MAAMqF,OACd,KAAK,GACDxC,KAAKnC,QAAQ4E,OACb,MACJ,KAAK,GACDzC,KAAKnC,QAAQ4C,UAAYT,KAAKQ,WAC9BR,KAAKnC,QAAQ4E,UAazB/B,UAAUO,UAAY,CAClByB,eAAgB,SAAU7E,SACtB,IAAI8E,EACJ,IAAKA,KAAK3C,KAAKa,SACX,GAAIb,KAAKa,SAAS8B,KAAO9E,QACrB,OAAO,EAGf,OAAO,GAEX+E,kBAAmB,SAAU/E,QAASgF,aAClC,IAAIC,cAAgBjF,QAAQE,wBACxBJ,UAAYrB,OAAO2B,SAASyD,cAAc,OAC1CqB,eAAiBzG,OAAO8B,iBAAiBP,SACzCmF,mBAAqBC,WAAWF,eAAeG,iBAAiB,wBAChEC,kBAAoBF,WAAWF,eAAeG,iBAAiB,uBAanE,GAXAvF,UAAUyF,gBAAkBvF,QAExBmF,oBACA5G,iBAAiB4G,oBAGjBG,mBACA/G,iBAAiB+G,mBAIO,IAAxBL,cAAcO,OAAwC,IAAzBP,cAAcQ,OAA/C,CAIA,IAAIC,aAAe,CACjB7D,MAAOqD,eAAeG,iBAAiB,sBACvC5E,KAAMyE,eAAeG,iBAAiB,qBACtC1E,IAAKuE,eAAeG,iBAAiB,oBACrC3D,OAAQwD,eAAeG,iBAAiB,wBAGtCM,UAAyC,eAA7BT,eAAeU,UAE3B9D,WAAasD,WAAWF,eAAeM,OACvC7D,YAAcyD,WAAWF,eAAeO,QACxCI,YAAclE,YACdmE,WAAahE,WAEZ6D,YACD7D,YAAcsD,WAAWF,eAAea,aAAeX,WAAWF,eAAec,cACjFrE,aAAeyD,WAAWF,eAAee,YAAcb,WAAWF,eAAegB,eACjFJ,WAAahE,WAAasD,WAAWM,aAAa7D,OAClDuD,WAAWM,aAAajF,MACxBoF,YAAclE,YAAcyD,WAAWM,aAAahE,QAAU0D,WAAWM,aAAa/E,MAI1F,IAAIwF,eAAiB,CACjBC,WAAY,cACZC,SAAU,eAGVC,gBAAkB,SAASC,MAC7B,IAAIC,UAAY,GAwBhB,OAtBIL,eAAeC,WAAWK,QAAQF,OAAS,GAC7CC,UAAiB,MAAKtB,eAAeG,iBAAiB,WAAakB,MACnEC,UAAkB,OAAI7E,YAAc,KACpC6E,UAAe,IAAI,EAEbb,YACFa,UAAkB,OAAI7E,YAAcyD,WAAWM,aAAa/E,KAAOyE,WAAWM,aAAahE,QAAU,QAIzG8E,UAAkB,OAAItB,eAAeG,iBAAiB,WAAakB,MACnEC,UAAiB,MAAI1E,WAAa,KAClC0E,UAAgB,KAAI,EAEdb,YACFa,UAAiB,MAAI1E,WAAasD,WAAWM,aAAajF,MAAQ2E,WAAWM,aAAa7D,OAAS,OAIzG2E,UAAUD,MAAQ,EAClBC,UAAoB,SAAI,WAEjBA,WAGPE,eAAiB,SAASH,MAC5B,IAAIC,UAAY,GAEZG,OAAS,GAoBb,OAnBAA,OAAc,MAAIvB,WAAWF,eAAeG,iBAAiB,iBAC7DsB,OAAY,IAAIvB,WAAWF,eAAeG,iBAAiB,eAC3DsB,OAAe,OAAIvB,WAAWF,eAAeG,iBAAiB,kBAC9DsB,OAAa,KAAIvB,WAAWF,eAAeG,iBAAiB,gBAEzDc,eAA2B,WAAEM,QAAQF,OAAS,GAE/CC,UAAiB,MAAItB,eAAeG,iBAAiB,UAAYkB,MACjEC,UAAkB,OAAIX,YAAcc,OAAY,IAAIA,OAAe,OAAI,KACvEH,UAAe,IAAI,KAAOG,OAAY,IAAIvB,WAAWM,aAAa/E,MAAS,OAE3E6F,UAAkB,OAAItB,eAAeG,iBAAiB,UAAYkB,MAClEC,UAAiB,MAAIV,WAAa,KAClCU,UAAgB,KAAI,IAAMd,aAAajF,MAGzC+F,UAAUD,MAAQ,KAAOI,OAAOJ,MAAQnB,WAAWM,aAAaa,QAAU,KAC1EC,UAAoB,SAAI,WAEjBA,WAGHI,cAAgB,SAAUC,KAErB3I,OAAO4I,gBAAgBC,mBACxBC,SAASH,GAAGpB,OAAQ,KAAO,GAC3BuB,SAASH,GAAGrB,MAAO,KAAO,EAE1BqB,GAAGI,QAAU,OAEbJ,GAAGI,QAAU,SAIjBC,cAAgBhJ,OAAO4I,gBAAgBK,YAEvCC,sBAAwB,CAC1Bd,gBAAgB,OAChBA,gBAAgB,SAChBA,gBAAgB,UAChBA,gBAAgB,SAGde,qBAOAC,oBAAsB,SAAUC,IAAKrJ,QACrC,IAAI4G,EACJ,IAAKA,EAAI,EAAGA,EAAIyC,IAAInD,OAAQU,IAAK,CAC7B8B,cAAcW,IAAIzC,IAGlByC,IAAIzC,GAAc,UAAI,OACtB,IAAI+B,GAAKpI,OAAO2B,SAASyD,cAAc,OACnC2D,OAMJC,gBANaC,OAAOC,OAChB,GACAzJ,OACAqJ,IAAIzC,IAGgB+B,GAAG/C,OAE3BhE,UAAUwE,YAAYuC,MAI9BS,oBA3B2B,CACzBZ,eAAe,OACfA,eAAe,SACfA,eAAe,UACfA,eAAe,SAyBbxI,OAAO4I,gBAAgBc,eAE3BN,oBACIF,sBACAlJ,OAAO4I,gBAAgBe,gBAG3B/H,UAAUgI,UAAY9I,oBAEtB,IAAIyE,OAAS1D,cAAcC,SASvBmH,YAAc,CACd1G,KAAQgD,OAAOhD,KAAO,KACtBE,IAAO8C,OAAO9C,IAAM,KACpB6E,MAASP,cAAcO,MAAQ,KAC/BC,OAAUR,cAAcQ,OAAS,KACjCsC,UAAW,IACXpB,OAAU,EACVqB,QAAW,EACXxH,SAAY,WACZyH,iBAAkB,OAClBC,aAAc,eACdC,aAAcjD,eAAeG,iBAAiB,cAC9C+C,eAAgBlD,eAAeG,iBAAiB,gBAChDgD,cAAenD,eAAeG,iBAAiB,eAC/CiD,aAAcpD,eAAeG,iBAAiB,cAC9CkD,gBAAiBrD,eAAeG,iBAAiB,iBACjDmD,eAAgBtK,OAAO4I,gBAAgB2B,aAGvCC,aAAehB,OAAOC,OAAO,GAAIR,YAAcjJ,OAAO4I,gBAAgBK,aAEtEwB,mBAAqBzK,OAAO4I,gBAAgB8B,kBAE5CC,iBAAmB3K,OAAO4I,gBAAgBgC,gBAE1CC,iBAAmB,CACnBC,sBAAuB,uCACvBC,sBAAuB,eAW3BxB,gBAAgBiB,aAAc5I,UAAUgE,OACxC2D,gBACIzC,YAAc2D,mBAAqBE,iBACnC/I,UAAUgE,OAIVkB,cACAyC,gBAAgBsB,iBAAkBjJ,UAAUgE,OAE5CrF,OAAOK,WAAW,WACd2I,gBAAgBoB,iBAAkB/I,UAAUgE,QAC7C,KAGPrF,OAAO2B,SAASD,KAAKmE,YAAYxE,WAvBjC,SAAS2H,gBAAgByB,YAAaC,KAClC,IAAIC,KAEJ,IAAKA,QAAQF,YACTC,IAAIpF,YAAYqF,KAAMF,YAAYE,SAsB9CC,IAAK,SAAUrJ,QAASgF,aACpB,IAAI7C,KAAK0C,eAAe7E,UAAYA,UAAYvB,OAAO2B,SAAvD,CAOA,GAJI+B,KAAKY,SACLjC,SAASd,QAAS,YAAa,KAG7BvB,OAAOa,OAASb,OAAOa,iBAAiBgK,gBAAkBhI,aAAatB,SAAU,CACnF,IAAIW,IAAMqB,qBAAqBhC,SAC3BW,MACAA,KAAQlC,OAAOkD,YAAc,EAC7BlD,OAAO8K,SAAS,EAAG5I,MAG3BwB,KAAKa,SAASwG,KAAKxJ,SAEnBmC,KAAK4C,kBAAkB/E,QAASgF,eAGpCyE,MAAO,WACH,IAAI3E,EAAG4E,WAAajL,OAAO2B,SAASuJ,iBAAiB,IAAM3K,qBACvDmB,KAAO1B,OAAO2B,SAASD,KAE3B,IAAK2E,EAAI,EAAGA,EAAI4E,WAAWtF,OAAQU,IAC/B3E,KAAKsE,YAAYiF,WAAW5E,IAGhC,GAAI3C,KAAKY,QACL,IAAK+B,EAAI,EAAGA,EAAI3C,KAAKa,SAASoB,OAAQU,IAClChE,SAASqB,KAAKa,SAAS8B,GAAI,YAAa,GAIhD3C,KAAKa,SAAW,IAGpB4G,OAAQ,WACJ,IAAI9E,EAAG+E,YAWP,IANIA,YADA1H,KAAKc,SACSxE,OAAO2B,SAASuJ,iBAAiBxH,KAAKc,UAEtCd,KAAKa,SAAS8G,MAAM,GAGtC3H,KAAKsH,QACA3E,EAAI,EAAGA,EAAI+E,YAAYzF,OAAQU,IAChC3C,KAAKkH,IAAIQ,YAAY/E,IAAI,KAoBrC,IAAIiF,QAAS,EAKb,SAASC,YAAY1K,OACbD,YAAYC,QACZH,gBAAgBkK,IAAI/J,MAAM2E,QAAQ,GAI1C,SAASgG,WAAW3K,OACZD,YAAYC,QACZH,gBAAgBsK,QAIxB,SAASS,YAAY5K,OACjB0K,YAAY1K,OACZb,OAAO2B,SAASsE,oBAAoB,YAAawF,aAGrD,SAAS7G,QAAQ/D,OACTD,YAAYC,SACZA,MAAMiE,iBACNjE,MAAM6K,kBACF7K,MAAM8K,OACNlH,cAAc5D,MAAM2E,QAEpBd,YAAY7D,MAAM2E,SAK9B,SAASoG,QAAQ/K,OACTyK,SAAW1K,YAAYC,SACvBb,OAAO2B,SAASsE,oBAAoB,QAAS2F,SAC7C5L,OAAO2B,SAASsE,oBAAoB,YAAasF,aACjDvL,OAAO2B,SAASsE,oBAAoB,WAAYuF,YAChDxL,OAAO2B,SAASsE,oBAAoB,YAAawF,aACjDzL,OAAO2B,SAASsE,oBAAoB,QAASrB,SAC7ClE,gBAAgBsK,QAChBtK,qBAAkBmL,EAClBP,QAAS,GAIjB,SAASQ,UAAUjL,QACVyK,QAAU1K,YAAYC,SACvBb,OAAO2B,SAASsC,iBAAiB,QAAS2H,SAC1C5L,OAAO2B,SAASsC,iBAAiB,YAAasH,aAC9CvL,OAAO2B,SAASsC,iBAAiB,WAAYuH,YAC7CxL,OAAO2B,SAASsC,iBAAiB,YAAawH,aAC9CzL,OAAO2B,SAASsC,iBAAiB,QAASW,SAC1ClE,gBAAkB,IAAI0D,UAAU,QAAQ,GACxCkH,QAAS,GAOjB,SAASS,SAASC,SACd,GAAKvL,aAAL,CAIA,IAAI4F,EACJ,IAAKA,KAFL5F,aAAasE,aAEHiH,QACNvL,aAAa8E,QAAQyG,QAAQ3F,IAEjC5F,aAAaqF,QAIjB,SAASmG,gBACDtL,mBACAA,iBAAiBqK,QACjBrK,iBAAmB,MAK3B,SAASU,UAAU6K,KAAMlB,OAChBrK,mBACDA,iBAAmB,IAAIyD,UAAU,SAEjC4G,OACArK,iBAAiBqK,QAErBrK,iBAAiBiK,IAAIsB,MAAM,GAI/B,SAASC,cAAcC,MACnBH,gBACA,IAAI5F,EAAGgG,MAAQrM,OAAO2B,SAASuJ,iBAAiBkB,MAChD,IAAK/F,EAAI,EAAGA,EAAIgG,MAAM1G,OAAQU,IAC1BhF,UAAUgL,MAAMhG,IAEpB1F,iBAAiB6D,SAAW4H,KAIhC,SAAShM,mBACDO,kBACAA,iBAAiBwK,SAQzB,SAASmB,eAAeC,GAGhBA,EAAE/G,SAAWxF,OAAO2B,SACpBvB,oBAEIO,kBAAoBD,kBACpBV,OAAOK,WAAWD,iBAAkB,GAWhD,SAASoM,eAAeC,cACpB/I,KAAK+I,aAAeA,aACpB/I,KAAKgJ,gBAAkB,KACvBhJ,KAAKiJ,kBAAoBF,aAAarH,cAAc,OAqExD,SAASwH,eAAeV,MACpB,OAAQA,KAAKW,WAAaC,KAAKC,cAAgB,qDAAqDC,KAAKd,KAAKe,SAiLlH,SAASC,cAAcC,OACnB7M,aAAa8M,MAAMD,OAOvB,SAASE,kBAAkBC,MACvB,IAAIC,KAAO,CAAEC,IAAKF,KAAKL,QAAQQ,cAAeC,WAAY,GAAIC,SAAU,IACpEtH,EACAuH,IACA1B,KACA3J,MAGJ,IADAqL,IAAMN,KAAKI,WAAW/H,OACjBU,EAAI,EAAGA,EAAIuH,IAAKvH,IAEjB9D,MAAuB,sBADvB2J,KAAOoB,KAAKI,WAAWjI,KAAKY,IACd/D,KAA+BiG,SAAS2D,KAAK3J,MAAO,IAAM2J,KAAK3J,MAC7EgL,KAAKG,WAAWxB,KAAK5J,MAAQC,MAIjC,IADAqL,IAAMN,KAAK5H,WAAWC,OACjBU,EAAI,EAAGA,EAAIuH,IAAKvH,KACjB6F,KAAOoB,KAAK5H,WAAWD,KAAKY,IAGnBwG,WAAaC,KAAKC,cAAgBb,KAAK7C,YAAc9I,oBAC1DgN,KAAKI,SAAS5C,KAAKsC,kBAAkBnB,OAC9BA,KAAKW,WAAaC,KAAKe,WAC9BN,KAAKI,SAAS5C,KAAK,CAAE+C,QAAS5B,KAAK6B,YAI3C,OAAOR,KAGX,SAASS,eACL,OAAOC,KAAKC,UAAUb,kBAAkBrN,OAAO2B,SAASqB,kBAG5D,SAASmL,aAAaC,WAElB,OADA3O,OAASwO,KAAKI,MAAMD,WACbH,KAAKC,UAAUzO,QA3T1BO,OAAOiE,iBAAiB,SAAU7D,kBAgBlCJ,OAAOiE,iBAAiB,SAAUqI,gBAAgB,GAkBlDE,eAAe7H,UAAU2J,iBAAmB,SAAUC,IAClD,IAAKA,GACD,OAAO,KAGX,GAAI7K,KAAKgJ,iBAAmBhJ,KAAKgJ,gBAAgB6B,IAC7C,OAAO7K,KAAKgJ,gBAAgB6B,IAGhC,IAAIC,QAAU9K,KAAK+I,aAAavB,iBAAiB,sBAAwBqD,GAAK,MAC9E,OAAOC,SAAWA,QAAQ,IAU9BhC,eAAe7H,UAAU8J,iBAAmB,SAAUC,cAAeC,aAAcC,MAC/E,IAAIC,OAASnL,KAAK4K,iBAAiBM,KAAKE,UACpCC,MAASrL,KAAK4K,iBAAiBM,KAAKI,SAEpCJ,KAAKK,WACLJ,OAASH,cAAcO,WAChBL,KAAKM,YACZH,MAAQL,cAAcQ,WAGtBL,OACAH,cAAcS,aAAaR,aAAcE,QAClCE,OAAUA,QAAUL,cAAcQ,UACzCR,cAAcS,aAAaR,aAAcI,MAAMK,aAE/CV,cAAc7I,YAAY8I,eAUlCnC,eAAe7H,UAAU0K,eAAiB,SAAUC,MAGhD,IAAIC,OAIJ,OAHA7L,KAAKiJ,kBAAkBxI,UAAYmL,KACnCC,OAAS7L,KAAKiJ,kBAAkB6C,YAChC9L,KAAKiJ,kBAAkB6C,YAAc,GAC9BD,QAkBX/C,eAAe7H,UAAU8K,aAAe,SAAUf,cAAeE,MAC7D,SAASc,uBAAuBxD,MAC5B,GACIA,KAAOA,KAAKyD,sBACPzD,MAAQA,KAAK7C,YAAc9I,qBACpC,OAAO2L,KAEX,SAAS0D,uBAAuB1D,MAC5B,GACIA,KAAOA,KAAKkD,kBACPlD,MAAQA,KAAK7C,YAAc9I,qBACpC,OAAO2L,KAEX,SAAS2D,4BAA4B3D,MAKjC,OAJAA,KAAQA,KAAKxG,WAAWC,OAASuG,KAAKxG,WAAWD,KAAKyG,KAAKxG,WAAWC,OAAS,GAAK,OACxEuG,KAAK7C,YAAc9I,sBAC3B2L,KAAOwD,uBAAuBxD,OAE3BA,KAeX,IAZA,IAAI4D,MAAmBlB,KAAY,QAAKlL,KAAK4K,iBAAiBM,KAAKI,SAAY,KAC3Ee,aAAkBnB,KAAKI,UAAYc,MACnCE,IAAmBpB,KAAa,SAAIlL,KAAK4K,iBAAiBM,KAAKE,UAAY,KAC3EmB,WAAkBrB,KAAKE,WAAakB,IACpCE,SAAkBJ,OAASF,uBAAuBE,OAClDK,QAAkBD,UAAaF,KAAON,uBAAuBM,MAASH,4BAA4BnB,eAClG0B,KACAC,cAAoCxE,IAAjB+C,KAAKd,QAAyBpK,KAAK+I,aAAa6D,eAAe1D,eAAe8B,eAAiBE,KAAKd,QAAUpK,KAAK2L,eAAeT,KAAKd,UAAY,KACtKyC,mBACAC,OAGGL,SAAYA,UAAYH,MAC3BQ,OAASL,QAAQtD,WAAaC,KAAKe,UAInCuC,KAAO,SAAaR,uBAAuBO,SAAWT,uBAAuBS,WAKxEA,QAAQtD,WAAaC,KAAKC,eACrBgD,cAAgBE,aAAgBO,QAAUD,sBAGhDA,mBAAqBC,OAEjBL,QAAQvM,OACRuM,QAAQvM,SACDuM,QAAQpK,YAAcoK,QAAQpK,WAAWC,aAChDmK,QAAQpK,WAAWC,YAAYmK,SAEnCA,QAAUC,KAIdC,WAGIP,OAASA,MAAMV,YACfV,cAAcS,aAAakB,SAAUP,MAAMV,aACpCY,IACPtB,cAAcS,aAAakB,SAAUL,KAErCtB,cAAc7I,YAAYwK,YAUtC7D,eAAe7H,UAAUyI,MAAQ,SAAUD,OACvC,IAAIsD,SACA/B,cACAC,aACA+B,KAAOhN,KAEXA,KAAKgJ,gBAAkB,GAEvBS,MAAMwD,QAAQ,SAAU/B,MACpB,IAAIgC,iBAAiC,kBAAdhC,KAAKxN,OAA0C,SAAbwN,KAAKpB,KAA+B,SAAboB,KAAKpB,KAA+B,SAAboB,KAAKpB,KAE5G,GAAkB,kBAAdoB,KAAKxN,KAgBT,GAHAqP,SAAW7B,KAAKxN,KAAKyP,MAAM,+DAAiEjC,KAAKkC,SAAWlC,KAAKmC,OACjHrC,cAAgBgC,KAAKpC,iBAAiBmC,YAEfG,iBAKvB,OAAQhC,KAAKxN,MACb,IAAK,aACL,IAAK,UACDsN,cAAchM,aAAakM,KAAKoC,UAAWN,KAAKrB,eAAeT,KAAKrM,QACpE,MACJ,IAAK,aACDmM,cAAc/L,gBAAgBiM,KAAKoC,WACnC,MACJ,IAAK,gBACGtC,cAAc9K,OACd8K,cAAc9K,SACP8K,cAAc3I,YAAc2I,cAAc3I,WAAWC,aAC5D0I,cAAc3I,WAAWC,YAAY0I,eAEzC,MACJ,IAAK,gBACDC,aAAe,KACXiC,oBAGAjC,aAAe+B,KAAKjE,aAA0B,SAAbmC,KAAKpB,IAAiB,kBAAoBoB,KAAKpB,QAG5EoD,kBAAmB,IAGtBA,mBACDjC,aAAe+B,KAAKjE,aAAarH,cAAcwJ,KAAKpB,MAGxDvE,OAAOgI,KAAKrC,KAAKlB,YAAYiD,QAAQ,SAAUO,MAC3CvC,aAAajM,aAAawO,KAAMR,KAAKrB,eAAeT,KAAKlB,WAAWwD,UAExEvC,aAAajM,aAAa,mBAAoBkM,KAAKmC,OAE9CH,kBACDF,KAAKjC,iBAAiBC,cAAeC,aAAcC,MAEvD,MACJ,IAAK,cACDD,aAAe+B,KAAKpC,iBAAiBM,KAAKmC,OAC1CL,KAAKjC,iBAAiBC,cAAeC,aAAcC,MACnD,MACJ,IAAK,aACD,IAAIuC,YAAcT,KAAKjE,aAAa6D,eAAe1D,eAAe8B,eAAiBE,KAAKd,QAAU4C,KAAKrB,eAAeT,KAAKd,UAC3H4C,KAAKjC,iBAAiBC,cAAeyC,YAAavC,MAClD,MACJ,IAAK,cACL,IAAK,aACD8B,KAAKjB,aAAaf,cAAeE,WArDjCwC,QAAQC,MAAM,oBAAsBZ,SAAW,mBAhB/C7B,KAAK0C,OAAOX,QAAQ,SAAUI,OAC1B,IAAI7E,KAAOwE,KAAKpC,iBAAiByC,OACjCL,KAAKhE,gBAAgBqE,OAAS7E,KAC1BA,KAAKtI,OACLsI,KAAKtI,SACEsI,KAAKnG,YAAcmG,KAAKnG,WAAWC,aAC1CkG,KAAKnG,WAAWC,YAAYkG,UAoE5CxI,KAAKgJ,gBAAkB,GAGvBtM,oBAkDJE,aAAe,IAAIkM,eAAexM,OAAO2B,UAErChC,cACAK,OAAO2B,SAASsC,iBAAiB,UAAW6H,WAGhD,IAAIyF,IAAM,KAEV,SAASC,gBAAgB3Q,OACrB,IAAIU,QAAUV,MAAM2E,OAChBiM,cACAC,UAEAH,KAAOhQ,SAAWA,QAAQoQ,aAAa,qBACvCJ,IAAIK,KAAK3D,KAAKC,UAAU,CACpB9M,KAAM,UACNyQ,QAAStQ,QAAQuQ,aAAa,uBAM1C,SAASC,mBACLR,IAAM,IAAIS,UAAU,kBAAoBtS,eACpCuS,OAAS,WACTjS,OAAO2B,SAASsC,iBAAiB,QAASuN,kBAG9CD,IAAIW,UAAY,SAAUC,OAG1BZ,IAAIa,QAAU,WAEVpS,OAAO2B,SAASsE,oBAAoB,QAASuL,kBAQrD,OAJI9R,cACAqS,kBAGG,CACHvF,eAA0BA,eAC1BT,SAA0BA,SAC1BE,cAA0BA,cAC1B5K,UAA0BA,UAC1B8K,cAA0BA,cAC1B/L,iBAA0BA,iBAC1B8M,cAA0BA,cAC1Bc,aAA0BA,aAC1BG,aAA0BA","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2012 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/*jslint forin: true */\n/*global Node, MessageEvent */\n/*theseus instrument: false */\n\n/**\n * RemoteFunctions define the functions to be executed in the browser. This\n * modules should define a single function that returns an object of all\n * exported functions.\n */\nfunction RemoteFunctions(config, remoteWSPort) {\n\n\n    var experimental;\n    if (!config) {\n        experimental = false;    \n    } else {\n        experimental = config.experimental;    \n    }\n    var req, timeout;\n    var animateHighlight = function (time) {\n        if(req) {\n            window.cancelAnimationFrame(req);\t\n            window.clearTimeout(timeout);\n        }\n        req = window.requestAnimationFrame(redrawHighlights);\n\n        timeout = setTimeout(function () {\n            window.cancelAnimationFrame(req);\t\n            req = null;\n        }, time * 1000);\n    };\n\n    /**\n     * @type {DOMEditHandler}\n     */\n    var _editHandler;\n\n    var HIGHLIGHT_CLASSNAME = \"__brackets-ld-highlight\";\n\n    // determine whether an event should be processed for Live Development\n    function _validEvent(event) {\n        if (window.navigator.platform.substr(0, 3) === \"Mac\") {\n            // Mac\n            return event.metaKey;\n        } else {\n            // Windows\n            return event.ctrlKey;\n        }\n    }\n\n    // determine the color for a type\n    function _typeColor(type, highlight) {\n        switch (type) {\n        case \"html\":\n            return highlight ? \"#eec\" : \"#ffe\";\n        case \"css\":\n            return highlight ? \"#cee\" : \"#eff\";\n        case \"js\":\n            return highlight ? \"#ccf\" : \"#eef\";\n        default:\n            return highlight ? \"#ddd\" : \"#eee\";\n        }\n    }\n\n    // compute the screen offset of an element\n    function _screenOffset(element) {\n        var elemBounds = element.getBoundingClientRect(),\n            body = window.document.body,\n            offsetTop,\n            offsetLeft;\n\n        if (window.getComputedStyle(body).position === \"static\") {\n            offsetLeft = elemBounds.left + window.pageXOffset;\n            offsetTop = elemBounds.top + window.pageYOffset;\n        } else {\n            var bodyBounds = body.getBoundingClientRect();\n            offsetLeft = elemBounds.left - bodyBounds.left;\n            offsetTop = elemBounds.top - bodyBounds.top;\n        }\n        return { left: offsetLeft, top: offsetTop };\n    }\n\n    // set an event on a element\n    function _trigger(element, name, value, autoRemove) {\n        var key = \"data-ld-\" + name;\n        if (value !== undefined && value !== null) {\n            element.setAttribute(key, value);\n            if (autoRemove) {\n                window.setTimeout(element.removeAttribute.bind(element, key));\n            }\n        } else {\n            element.removeAttribute(key);\n        }\n    }\n    \n    // Checks if the element is in Viewport in the client browser\n    function isInViewport(element) {\n        var rect = element.getBoundingClientRect();\n        var html = window.document.documentElement;\n        return (\n            rect.top >= 0 &&\n            rect.left >= 0 &&\n            rect.bottom <= (window.innerHeight || html.clientHeight) &&\n            rect.right <= (window.innerWidth || html.clientWidth)\n        );\n    }\n    \n    // returns the distance from the top of the closest relatively positioned parent element\n    function getDocumentOffsetTop(element) {\n        return element.offsetTop + (element.offsetParent ? getDocumentOffsetTop(element.offsetParent) : 0);\n    }\n\n    // construct the info menu\n    function Menu(element) {\n        this.element = element;\n        _trigger(this.element, \"showgoto\", 1, true);\n        window.setTimeout(window.remoteShowGoto);\n        this.remove = this.remove.bind(this);\n    }\n\n    Menu.prototype = {\n        onClick: function (url, event) {\n            event.preventDefault();\n            _trigger(this.element, \"goto\", url, true);\n            this.remove();\n        },\n\n        createBody: function () {\n            if (this.body) {\n                return;\n            }\n\n            // compute the position on screen\n            var offset = _screenOffset(this.element),\n                x = offset.left,\n                y = offset.top + this.element.offsetHeight;\n\n            // create the container\n            this.body = window.document.createElement(\"div\");\n            this.body.style.setProperty(\"z-index\", 2147483647);\n            this.body.style.setProperty(\"position\", \"absolute\");\n            this.body.style.setProperty(\"left\", x + \"px\");\n            this.body.style.setProperty(\"top\", y + \"px\");\n            this.body.style.setProperty(\"font-size\", \"11pt\");\n\n            // draw the background\n            this.body.style.setProperty(\"background\", \"#fff\");\n            this.body.style.setProperty(\"border\", \"1px solid #888\");\n            this.body.style.setProperty(\"-webkit-box-shadow\", \"2px 2px 6px 0px #ccc\");\n            this.body.style.setProperty(\"border-radius\", \"6px\");\n            this.body.style.setProperty(\"padding\", \"6px\");\n        },\n\n        addItem: function (target) {\n            var item = window.document.createElement(\"div\");\n            item.style.setProperty(\"padding\", \"2px 6px\");\n            if (this.body.childNodes.length > 0) {\n                item.style.setProperty(\"border-top\", \"1px solid #ccc\");\n            }\n            item.style.setProperty(\"cursor\", \"pointer\");\n            item.style.setProperty(\"background\", _typeColor(target.type));\n            item.innerHTML = target.name;\n            item.addEventListener(\"click\", this.onClick.bind(this, target.url));\n\n            if (target.file) {\n                var file = window.document.createElement(\"i\");\n                file.style.setProperty(\"float\", \"right\");\n                file.style.setProperty(\"margin-left\", \"12px\");\n                file.innerHTML = \" \" + target.file;\n                item.appendChild(file);\n            }\n            this.body.appendChild(item);\n        },\n\n        show: function () {\n            if (!this.body) {\n                this.body = this.createBody();\n            }\n            if (!this.body.parentNode) {\n                window.document.body.appendChild(this.body);\n            }\n            window.document.addEventListener(\"click\", this.remove);\n        },\n\n        remove: function () {\n            if (this.body && this.body.parentNode) {\n                window.document.body.removeChild(this.body);\n            }\n            window.document.removeEventListener(\"click\", this.remove);\n        }\n\n    };\n\n    function Editor(element) {\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyPress = this.onKeyPress.bind(this);\n\n        this.element = element;\n        this.element.setAttribute(\"contenteditable\", \"true\");\n        this.element.focus();\n        this.element.addEventListener(\"blur\", this.onBlur);\n        this.element.addEventListener(\"keypress\", this.onKeyPress);\n\n        this.revertText = this.element.innerHTML;\n\n        _trigger(this.element, \"edit\", 1);\n    }\n\n    Editor.prototype = {\n        onBlur: function (event) {\n            this.element.removeAttribute(\"contenteditable\");\n            this.element.removeEventListener(\"blur\", this.onBlur);\n            this.element.removeEventListener(\"keypress\", this.onKeyPress);\n            _trigger(this.element, \"edit\", 0, true);\n        },\n\n        onKeyPress: function (event) {\n            switch (event.which) {\n            case 13: // return\n                this.element.blur();\n                break;\n            case 27: // esc\n                this.element.innerHTML = this.revertText;\n                this.element.blur();\n                break;\n            }\n        }\n    };\n\n    function Highlight(color, trigger) {\n        this.color = color;\n        this.trigger = !!trigger;\n        this.elements = [];\n        this.selector = \"\";\n    }\n\n    Highlight.prototype = {\n        _elementExists: function (element) {\n            var i;\n            for (i in this.elements) {\n                if (this.elements[i] === element) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        _makeHighlightDiv: function (element, doAnimation) {\n            var elementBounds = element.getBoundingClientRect(),\n                highlight = window.document.createElement(\"div\"),\n                elementStyling = window.getComputedStyle(element),\n                transitionDuration = parseFloat(elementStyling.getPropertyValue('transition-duration')),\n                animationDuration = parseFloat(elementStyling.getPropertyValue('animation-duration'));\n\n            highlight.trackingElement = element; // save which node are we highlighting\n            \n            if (transitionDuration) {\n                animateHighlight(transitionDuration);\n            }\n\n            if (animationDuration) {\n                animateHighlight(animationDuration);\n            }\n\n            // Don't highlight elements with 0 width & height\n            if (elementBounds.width === 0 && elementBounds.height === 0) {\n                return;\n            }\n            \n            var realElBorder = {\n              right: elementStyling.getPropertyValue('border-right-width'),\n              left: elementStyling.getPropertyValue('border-left-width'),\n              top: elementStyling.getPropertyValue('border-top-width'),\n              bottom: elementStyling.getPropertyValue('border-bottom-width')\n            };\n            \n            var borderBox = elementStyling.boxSizing === 'border-box';\n            \n            var innerWidth = parseFloat(elementStyling.width),\n                innerHeight = parseFloat(elementStyling.height),\n                outerHeight = innerHeight,\n                outerWidth = innerWidth;\n                \n            if (!borderBox) {\n                innerWidth += parseFloat(elementStyling.paddingLeft) + parseFloat(elementStyling.paddingRight);\n                innerHeight += parseFloat(elementStyling.paddingTop) + parseFloat(elementStyling.paddingBottom);\n                outerWidth = innerWidth + parseFloat(realElBorder.right) +\n                parseFloat(realElBorder.left),\n                outerHeight = innerHeight + parseFloat(realElBorder.bottom) + parseFloat(realElBorder.top);\n            }\n\n          \n            var visualisations = {\n                horizontal: \"left, right\",\n                vertical: \"top, bottom\"\n            };\n          \n            var drawPaddingRect = function(side) {\n              var elStyling = {};\n                \n              if (visualisations.horizontal.indexOf(side) >= 0) {\n                elStyling['width'] =  elementStyling.getPropertyValue('padding-' + side);\n                elStyling['height'] = innerHeight + \"px\";\n                elStyling['top'] = 0;\n                  \n                  if (borderBox) {\n                    elStyling['height'] = innerHeight - parseFloat(realElBorder.top) - parseFloat(realElBorder.bottom) + \"px\";\n                  }\n                \n              } else {\n                elStyling['height'] = elementStyling.getPropertyValue('padding-' + side);  \n                elStyling['width'] = innerWidth + \"px\";\n                elStyling['left'] = 0;\n                  \n                  if (borderBox) {\n                    elStyling['width'] = innerWidth - parseFloat(realElBorder.left) - parseFloat(realElBorder.right) + \"px\";\n                  }\n              }\n                \n              elStyling[side] = 0;\n              elStyling['position'] = 'absolute';\n              \n              return elStyling;\n            };\n          \n          var drawMarginRect = function(side) {\n            var elStyling = {};\n            \n            var margin = [];\n            margin['right'] = parseFloat(elementStyling.getPropertyValue('margin-right'));\n            margin['top'] = parseFloat(elementStyling.getPropertyValue('margin-top'));\n            margin['bottom'] = parseFloat(elementStyling.getPropertyValue('margin-bottom'));\n            margin['left'] = parseFloat(elementStyling.getPropertyValue('margin-left'));\n          \n            if(visualisations['horizontal'].indexOf(side) >= 0) {\n\n              elStyling['width'] = elementStyling.getPropertyValue('margin-' + side);\n              elStyling['height'] = outerHeight + margin['top'] + margin['bottom'] + \"px\";\n              elStyling['top'] = \"-\" + (margin['top'] + parseFloat(realElBorder.top))  + \"px\";\n            } else {\n              elStyling['height'] = elementStyling.getPropertyValue('margin-' + side);\n              elStyling['width'] = outerWidth + \"px\";\n              elStyling['left'] = \"-\" + realElBorder.left;\n            }\n\n            elStyling[side] = \"-\" + (margin[side] + parseFloat(realElBorder[side])) + \"px\";\n            elStyling['position'] = 'absolute';\n\n            return elStyling;\n          };\n\n            var setVisibility = function (el) {\n                if (\n                    !config.remoteHighlight.showPaddingMargin || \n                    parseInt(el.height, 10) <= 0 || \n                    parseInt(el.width, 10) <= 0 \n                ) {\n                    el.display = 'none';\n                } else {\n                    el.display = 'block';\n                }\n            };\n            \n            var mainBoxStyles = config.remoteHighlight.stylesToSet;\n            \n            var paddingVisualisations = [\n              drawPaddingRect('top'),\n              drawPaddingRect('right'),\n              drawPaddingRect('bottom'),\n              drawPaddingRect('left')  \n            ];\n                \n            var marginVisualisations = [\n              drawMarginRect('top'),\n              drawMarginRect('right'),\n              drawMarginRect('bottom'),\n              drawMarginRect('left')  \n            ];\n            \n            var setupVisualisations = function (arr, config) {\n                var i;\n                for (i = 0; i < arr.length; i++) {\n                    setVisibility(arr[i]);\n                    \n                    // Applies to every visualisationElement (padding or margin div)\n                    arr[i][\"transform\"] = \"none\";\n                    var el = window.document.createElement(\"div\"),\n                        styles = Object.assign(\n                        {},\n                        config,\n                        arr[i]\n                    );\n\n                    _setStyleValues(styles, el.style);\n\n                    highlight.appendChild(el);\n                }\n            };\n            \n            setupVisualisations(\n                marginVisualisations,\n                config.remoteHighlight.marginStyling\n            );\n            setupVisualisations(\n                paddingVisualisations,\n                config.remoteHighlight.paddingStyling\n            );\n            \n            highlight.className = HIGHLIGHT_CLASSNAME;\n\n            var offset = _screenOffset(element);\n            \t\t\n            // some code to find element left/top was removed here. This seems to be relevant to box model\n            // live highlights. firether reading: https://github.com/adobe/brackets/pull/13357/files\n            // we removed this in phoenix because it was throwing the rendering of live highlight boxes in phonix\n            // default project at improper places. Some other cases might fail as the above code said they\n            // introduces that removed computation for fixing some box-model regression. If you are here to fix a\n            // related bug, check history of this changes in git.\n\n            var stylesToSet = {\n                \"left\": offset.left + \"px\",\n                \"top\": offset.top + \"px\",\n                \"width\": elementBounds.width + \"px\",\n                \"height\": elementBounds.height + \"px\",\n                \"z-index\": 2000000,\n                \"margin\": 0,\n                \"padding\": 0,\n                \"position\": \"absolute\",\n                \"pointer-events\": \"none\",\n                \"box-shadow\": \"0 0 1px #fff\",\n                \"box-sizing\": elementStyling.getPropertyValue('box-sizing'),\t\t\n                \"border-right\": elementStyling.getPropertyValue('border-right'),\t\t\n                \"border-left\": elementStyling.getPropertyValue('border-left'),\t\t\n                \"border-top\": elementStyling.getPropertyValue('border-top'),\t\t\n                \"border-bottom\": elementStyling.getPropertyValue('border-bottom'),\n                \"border-color\": config.remoteHighlight.borderColor\n            };\n            \n            var mergedStyles = Object.assign({}, stylesToSet,  config.remoteHighlight.stylesToSet);\n\n            var animateStartValues = config.remoteHighlight.animateStartValue;\n\n            var animateEndValues = config.remoteHighlight.animateEndValue;\n\n            var transitionValues = {\n                \"transition-property\": \"opacity, background-color, transform\",\n                \"transition-duration\": \"300ms, 2.3s\"\n            };\n\n            function _setStyleValues(styleValues, obj) {\n                var prop;\n\n                for (prop in styleValues) {\n                    obj.setProperty(prop, styleValues[prop]);\n                }\n            }\n\n            _setStyleValues(mergedStyles, highlight.style);\n            _setStyleValues(\n                doAnimation ? animateStartValues : animateEndValues,\n                highlight.style\n            );\n\n\n            if (doAnimation) {\n                _setStyleValues(transitionValues, highlight.style);\n\n                window.setTimeout(function () {\n                    _setStyleValues(animateEndValues, highlight.style);\n                }, 20);\n            }\n\n            window.document.body.appendChild(highlight);\n        },\n\n        add: function (element, doAnimation) {\n            if (this._elementExists(element) || element === window.document) {\n                return;\n            }\n            if (this.trigger) {\n                _trigger(element, \"highlight\", 1);\n            }\n            \n            if ((!window.event || window.event instanceof MessageEvent) && !isInViewport(element)) {\n                var top = getDocumentOffsetTop(element);\n                if (top) {\n                    top -= (window.innerHeight / 2);\n                    window.scrollTo(0, top);\n                }\n            }\n            this.elements.push(element);\n\n            this._makeHighlightDiv(element, doAnimation);\n        },\n\n        clear: function () {\n            var i, highlights = window.document.querySelectorAll(\".\" + HIGHLIGHT_CLASSNAME),\n                body = window.document.body;\n\n            for (i = 0; i < highlights.length; i++) {\n                body.removeChild(highlights[i]);\n            }\n\n            if (this.trigger) {\n                for (i = 0; i < this.elements.length; i++) {\n                    _trigger(this.elements[i], \"highlight\", 0);\n                }\n            }\n\n            this.elements = [];\n        },\n\n        redraw: function () {\n            var i, highlighted;\n\n            // When redrawing a selector-based highlight, run a new selector\n            // query to ensure we have the latest set of elements to highlight.\n            if (this.selector) {\n                highlighted = window.document.querySelectorAll(this.selector);\n            } else {\n                highlighted = this.elements.slice(0);\n            }\n\n            this.clear();\n            for (i = 0; i < highlighted.length; i++) {\n                this.add(highlighted[i], false);\n            }\n        }\n    };\n\n    var _currentEditor;\n    function _toggleEditor(element) {\n        _currentEditor = new Editor(element);\n    }\n\n    var _currentMenu;\n    function _toggleMenu(element) {\n        if (_currentMenu) {\n            _currentMenu.remove();\n        }\n        _currentMenu = new Menu(element);\n    }\n\n    var _localHighlight;\n    var _remoteHighlight;\n    var _setup = false;\n\n\n    /** Event Handlers ***********************************************************/\n\n    function onMouseOver(event) {\n        if (_validEvent(event)) {\n            _localHighlight.add(event.target, true);\n        }\n    }\n\n    function onMouseOut(event) {\n        if (_validEvent(event)) {\n            _localHighlight.clear();\n        }\n    }\n\n    function onMouseMove(event) {\n        onMouseOver(event);\n        window.document.removeEventListener(\"mousemove\", onMouseMove);\n    }\n\n    function onClick(event) {\n        if (_validEvent(event)) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (event.altKey) {\n                _toggleEditor(event.target);\n            } else {\n                _toggleMenu(event.target);\n            }\n        }\n    }\n\n    function onKeyUp(event) {\n        if (_setup && !_validEvent(event)) {\n            window.document.removeEventListener(\"keyup\", onKeyUp);\n            window.document.removeEventListener(\"mouseover\", onMouseOver);\n            window.document.removeEventListener(\"mouseout\", onMouseOut);\n            window.document.removeEventListener(\"mousemove\", onMouseMove);\n            window.document.removeEventListener(\"click\", onClick);\n            _localHighlight.clear();\n            _localHighlight = undefined;\n            _setup = false;\n        }\n    }\n\n    function onKeyDown(event) {\n        if (!_setup && _validEvent(event)) {\n            window.document.addEventListener(\"keyup\", onKeyUp);\n            window.document.addEventListener(\"mouseover\", onMouseOver);\n            window.document.addEventListener(\"mouseout\", onMouseOut);\n            window.document.addEventListener(\"mousemove\", onMouseMove);\n            window.document.addEventListener(\"click\", onClick);\n            _localHighlight = new Highlight(\"#ecc\", true);\n            _setup = true;\n        }\n    }\n\n    /** Public Commands **********************************************************/\n\n    // show goto\n    function showGoto(targets) {\n        if (!_currentMenu) {\n            return;\n        }\n        _currentMenu.createBody();\n        var i;\n        for (i in targets) {\n            _currentMenu.addItem(targets[i]);\n        }\n        _currentMenu.show();\n    }\n\n    // remove active highlights\n    function hideHighlight() {\n        if (_remoteHighlight) {\n            _remoteHighlight.clear();\n            _remoteHighlight = null;\n        }\n    }\n\n    // highlight a node\n    function highlight(node, clear) {\n        if (!_remoteHighlight) {\n            _remoteHighlight = new Highlight(\"#cfc\");\n        }\n        if (clear) {\n            _remoteHighlight.clear();\n        }\n        _remoteHighlight.add(node, true);\n    }\n\n    // highlight a rule\n    function highlightRule(rule) {\n        hideHighlight();\n        var i, nodes = window.document.querySelectorAll(rule);\n        for (i = 0; i < nodes.length; i++) {\n            highlight(nodes[i]);\n        }\n        _remoteHighlight.selector = rule;\n    }\n\n    // redraw active highlights\n    function redrawHighlights() {\n        if (_remoteHighlight) {\n            _remoteHighlight.redraw();\n        }\n    }\n\n    window.addEventListener(\"resize\", redrawHighlights);\n    // Add a capture-phase scroll listener to update highlights when\n    // any element scrolls.\n\n    function _scrollHandler(e) {\n        // Document scrolls can be updated immediately. Any other scrolls\n        // need to be updated on a timer to ensure the layout is correct.\n        if (e.target === window.document) {\n            redrawHighlights();\n        } else {\n            if (_remoteHighlight || _localHighlight) {\n                window.setTimeout(redrawHighlights, 0);\n            }\n        }\n    }\n\n    window.addEventListener(\"scroll\", _scrollHandler, true);\n\n    /**\n     * Constructor\n     * @param {Document} htmlDocument\n     */\n    function DOMEditHandler(htmlDocument) {\n        this.htmlDocument = htmlDocument;\n        this.rememberedNodes = null;\n        this.entityParseParent = htmlDocument.createElement(\"div\");\n    }\n\n    /**\n     * @private\n     * Find the first matching element with the specified data-brackets-id\n     * @param {string} id\n     * @return {Element}\n     */\n    DOMEditHandler.prototype._queryBracketsID = function (id) {\n        if (!id) {\n            return null;\n        }\n\n        if (this.rememberedNodes && this.rememberedNodes[id]) {\n            return this.rememberedNodes[id];\n        }\n\n        var results = this.htmlDocument.querySelectorAll(\"[data-brackets-id='\" + id + \"']\");\n        return results && results[0];\n    };\n\n    /**\n     * @private\n     * Insert a new child element\n     * @param {Element} targetElement Parent element already in the document\n     * @param {Element} childElement New child element\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._insertChildNode = function (targetElement, childElement, edit) {\n        var before = this._queryBracketsID(edit.beforeID),\n            after  = this._queryBracketsID(edit.afterID);\n\n        if (edit.firstChild) {\n            before = targetElement.firstChild;\n        } else if (edit.lastChild) {\n            after = targetElement.lastChild;\n        }\n\n        if (before) {\n            targetElement.insertBefore(childElement, before);\n        } else if (after && (after !== targetElement.lastChild)) {\n            targetElement.insertBefore(childElement, after.nextSibling);\n        } else {\n            targetElement.appendChild(childElement);\n        }\n    };\n\n    /**\n     * @private\n     * Given a string containing encoded entity references, returns the string with the entities decoded.\n     * @param {string} text The text to parse.\n     * @return {string} The decoded text.\n     */\n    DOMEditHandler.prototype._parseEntities = function (text) {\n        // Kind of a hack: just set the innerHTML of a div to the text, which will parse the entities, then\n        // read the content out.\n        var result;\n        this.entityParseParent.innerHTML = text;\n        result = this.entityParseParent.textContent;\n        this.entityParseParent.textContent = \"\";\n        return result;\n    };\n\n    /**\n     * @private\n     * @param {Node} node\n     * @return {boolean} true if node expects its content to be raw text (not parsed for entities) according to the HTML5 spec.\n     */\n    function _isRawTextNode(node) {\n        return (node.nodeType === Node.ELEMENT_NODE && /script|style|noscript|noframes|noembed|iframe|xmp/i.test(node.tagName));\n    }\n\n    /**\n     * @private\n     * Replace a range of text and comment nodes with an optional new text node\n     * @param {Element} targetElement\n     * @param {Object} edit\n     */\n    DOMEditHandler.prototype._textReplace = function (targetElement, edit) {\n        function prevIgnoringHighlights(node) {\n            do {\n                node = node.previousSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function nextIgnoringHighlights(node) {\n            do {\n                node = node.nextSibling;\n            } while (node && node.className === HIGHLIGHT_CLASSNAME);\n            return node;\n        }\n        function lastChildIgnoringHighlights(node) {\n            node = (node.childNodes.length ? node.childNodes.item(node.childNodes.length - 1) : null);\n            if (node && node.className === HIGHLIGHT_CLASSNAME) {\n                node = prevIgnoringHighlights(node);\n            }\n            return node;\n        }\n\n        var start           = (edit.afterID)  ? this._queryBracketsID(edit.afterID)  : null,\n            startMissing    = edit.afterID && !start,\n            end             = (edit.beforeID) ? this._queryBracketsID(edit.beforeID) : null,\n            endMissing      = edit.beforeID && !end,\n            moveNext        = start && nextIgnoringHighlights(start),\n            current         = moveNext || (end && prevIgnoringHighlights(end)) || lastChildIgnoringHighlights(targetElement),\n            next,\n            textNode        = (edit.content !== undefined) ? this.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : this._parseEntities(edit.content)) : null,\n            lastRemovedWasText,\n            isText;\n\n        // remove all nodes inside the range\n        while (current && (current !== end)) {\n            isText = current.nodeType === Node.TEXT_NODE;\n\n            // if start is defined, delete following text nodes\n            // if start is not defined, delete preceding text nodes\n            next = (moveNext) ? nextIgnoringHighlights(current) : prevIgnoringHighlights(current);\n\n            // only delete up to the nearest element.\n            // if the start/end tag was deleted in a prior edit, stop removing\n            // nodes when we hit adjacent text nodes\n            if ((current.nodeType === Node.ELEMENT_NODE) ||\n                    ((startMissing || endMissing) && (isText && lastRemovedWasText))) {\n                break;\n            } else {\n                lastRemovedWasText = isText;\n\n                if (current.remove) {\n                    current.remove();\n                } else if (current.parentNode && current.parentNode.removeChild) {\n                    current.parentNode.removeChild(current);\n                }\n                current = next;\n            }\n        }\n\n        if (textNode) {\n            // OK to use nextSibling here (not nextIgnoringHighlights) because we do literally\n            // want to insert immediately after the start tag.\n            if (start && start.nextSibling) {\n                targetElement.insertBefore(textNode, start.nextSibling);\n            } else if (end) {\n                targetElement.insertBefore(textNode, end);\n            } else {\n                targetElement.appendChild(textNode);\n            }\n        }\n    };\n\n    /**\n     * @private\n     * Apply an array of DOM edits to the document\n     * @param {Array.<Object>} edits\n     */\n    DOMEditHandler.prototype.apply = function (edits) {\n        var targetID,\n            targetElement,\n            childElement,\n            self = this;\n\n        this.rememberedNodes = {};\n\n        edits.forEach(function (edit) {\n            var editIsSpecialTag = edit.type === \"elementInsert\" && (edit.tag === \"html\" || edit.tag === \"head\" || edit.tag === \"body\");\n\n            if (edit.type === \"rememberNodes\") {\n                edit.tagIDs.forEach(function (tagID) {\n                    var node = self._queryBracketsID(tagID);\n                    self.rememberedNodes[tagID] = node;\n                    if (node.remove) {\n                        node.remove();\n                    } else if (node.parentNode && node.parentNode.removeChild) {\n                        node.parentNode.removeChild(node);\n                    }\n                });\n                return;\n            }\n\n            targetID = edit.type.match(/textReplace|textDelete|textInsert|elementInsert|elementMove/) ? edit.parentID : edit.tagID;\n            targetElement = self._queryBracketsID(targetID);\n\n            if (!targetElement && !editIsSpecialTag) {\n                console.error(\"data-brackets-id=\" + targetID + \" not found\");\n                return;\n            }\n\n            switch (edit.type) {\n            case \"attrChange\":\n            case \"attrAdd\":\n                targetElement.setAttribute(edit.attribute, self._parseEntities(edit.value));\n                break;\n            case \"attrDelete\":\n                targetElement.removeAttribute(edit.attribute);\n                break;\n            case \"elementDelete\":\n                if (targetElement.remove) {\n                    targetElement.remove();\n                } else if (targetElement.parentNode && targetElement.parentNode.removeChild) {\n                    targetElement.parentNode.removeChild(targetElement);\n                }\n                break;\n            case \"elementInsert\":\n                childElement = null;\n                if (editIsSpecialTag) {\n                    // If we already have one of these elements (which we should), then\n                    // just copy the attributes and set the ID.\n                    childElement = self.htmlDocument[edit.tag === \"html\" ? \"documentElement\" : edit.tag];\n                    if (!childElement) {\n                        // Treat this as a normal insertion.\n                        editIsSpecialTag = false;\n                    }\n                }\n                if (!editIsSpecialTag) {\n                    childElement = self.htmlDocument.createElement(edit.tag);\n                }\n\n                Object.keys(edit.attributes).forEach(function (attr) {\n                    childElement.setAttribute(attr, self._parseEntities(edit.attributes[attr]));\n                });\n                childElement.setAttribute(\"data-brackets-id\", edit.tagID);\n\n                if (!editIsSpecialTag) {\n                    self._insertChildNode(targetElement, childElement, edit);\n                }\n                break;\n            case \"elementMove\":\n                childElement = self._queryBracketsID(edit.tagID);\n                self._insertChildNode(targetElement, childElement, edit);\n                break;\n            case \"textInsert\":\n                var textElement = self.htmlDocument.createTextNode(_isRawTextNode(targetElement) ? edit.content : self._parseEntities(edit.content));\n                self._insertChildNode(targetElement, textElement, edit);\n                break;\n            case \"textReplace\":\n            case \"textDelete\":\n                self._textReplace(targetElement, edit);\n                break;\n            }\n        });\n\n        this.rememberedNodes = {};\n\n        // update highlight after applying diffs\n        redrawHighlights();\n    };\n\n    function applyDOMEdits(edits) {\n        _editHandler.apply(edits);\n    }\n\n    /**\n     *\n     * @param {Element} elem\n     */\n    function _domElementToJSON(elem) {\n        var json = { tag: elem.tagName.toLowerCase(), attributes: {}, children: [] },\n            i,\n            len,\n            node,\n            value;\n\n        len = elem.attributes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.attributes.item(i);\n            value = (node.name === \"data-brackets-id\") ? parseInt(node.value, 10) : node.value;\n            json.attributes[node.name] = value;\n        }\n\n        len = elem.childNodes.length;\n        for (i = 0; i < len; i++) {\n            node = elem.childNodes.item(i);\n\n            // ignores comment nodes and visuals generated by live preview\n            if (node.nodeType === Node.ELEMENT_NODE && node.className !== HIGHLIGHT_CLASSNAME) {\n                json.children.push(_domElementToJSON(node));\n            } else if (node.nodeType === Node.TEXT_NODE) {\n                json.children.push({ content: node.nodeValue });\n            }\n        }\n\n        return json;\n    }\n\n    function getSimpleDOM() {\n        return JSON.stringify(_domElementToJSON(window.document.documentElement));\n    }\n    \n    function updateConfig(newConfig) {\n        config = JSON.parse(newConfig);\n        return JSON.stringify(config);\n    }\n\n    // init\n    _editHandler = new DOMEditHandler(window.document);\n\n    if (experimental) {\n        window.document.addEventListener(\"keydown\", onKeyDown);\n    }\n    \n    var _ws = null;\n\n    function onDocumentClick(event) {\n        var element = event.target,\n            currentDataId,\n            newDataId;\n        \n        if (_ws && element && element.hasAttribute('data-brackets-id')) {\n            _ws.send(JSON.stringify({\n                type: \"message\",\n                message: element.getAttribute('data-brackets-id')\n            }));\n        }\n    }\n    \n    \n    function createWebSocket() {\n        _ws = new WebSocket(\"ws://localhost:\" + remoteWSPort);\n        _ws.onopen = function () {\n            window.document.addEventListener(\"click\", onDocumentClick);\n        };\n                \n        _ws.onmessage = function (evt) {\n        };\n                \n        _ws.onclose = function () {\n            // websocket is closed\n            window.document.removeEventListener(\"click\", onDocumentClick);\n        };\n    }\n    \n    if (remoteWSPort) {\n        createWebSocket();\n    }\n    \n    return {\n        \"DOMEditHandler\"        : DOMEditHandler,\n        \"showGoto\"              : showGoto,\n        \"hideHighlight\"         : hideHighlight,\n        \"highlight\"             : highlight,\n        \"highlightRule\"         : highlightRule,\n        \"redrawHighlights\"      : redrawHighlights,\n        \"applyDOMEdits\"         : applyDOMEdits,\n        \"getSimpleDOM\"          : getSimpleDOM,\n        \"updateConfig\"          : updateConfig\n    };\n}\n"],"file":"RemoteFunctions.js"}