define(function ScriptAgent(require,exports,module){var Inspector=require("LiveDevelopment/Inspector/Inspector"),DOMAgent=require("LiveDevelopment/Agents/DOMAgent"),_load,_urlToScript,_idToScript,_insertTrace;function scriptWithId(url){return _idToScript[url]}function scriptForURL(url){return _urlToScript[url]}function _onGetDocument(event,res){Inspector.DOMDebugger.setDOMBreakpoint(res.root.nodeId,"subtree-modified"),_load.resolve()}function _onChildNodeInserted(event,res){var node;_insertTrace&&(DOMAgent.nodeWithId(res.node.nodeId).trace=_insertTrace,_insertTrace=void 0)}function _onScriptParsed(event,res){_idToScript[res.scriptId]=res,_urlToScript[res.url]=res}function _onScriptFailedToParse(event,res){}function _onPaused(event,res){switch(res.reason){case"exception":Inspector.Debugger.resume();break;case"DOM":Inspector.Debugger.resume(),"subtree-modified"===res.data.type&&!0===res.data.insertion&&(_insertTrace=res.callFrames)}}function _reset(){_urlToScript={},_idToScript={}}function _onFrameNavigated(event,res){res.frame.parentId||_reset()}function load(){_reset(),_load=new $.Deferred;var enableResult=new $.Deferred;return Inspector.Debugger.enable().done(function(){Inspector.Debugger.setPauseOnExceptions("uncaught").done(function(){enableResult.resolve()})}),Inspector.Page.on("frameNavigated.ScriptAgent",_onFrameNavigated),DOMAgent.on("getDocument.ScriptAgent",_onGetDocument),Inspector.Debugger.on("scriptParsed.ScriptAgent",_onScriptParsed).on("scriptFailedToParse.ScriptAgent",_onScriptFailedToParse).on("paused.ScriptAgent",_onPaused),Inspector.DOM.on("childNodeInserted.ScriptAgent",_onChildNodeInserted),$.when(_load.promise(),enableResult.promise())}function unload(){_reset(),Inspector.Page.off(".ScriptAgent"),DOMAgent.off(".ScriptAgent"),Inspector.Debugger.off(".ScriptAgent"),Inspector.DOM.off(".ScriptAgent")}exports.scriptWithId=scriptWithId,exports.scriptForURL=scriptForURL,exports.load=load,exports.unload=unload});
//# sourceMappingURL=ScriptAgent.js.map
