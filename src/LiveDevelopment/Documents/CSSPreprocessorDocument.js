define(function CSSPreprocessorDocumentModule(require,exports,module){var _=require("thirdparty/lodash"),EventDispatcher=require("utils/EventDispatcher"),CSSUtils=require("language/CSSUtils"),EditorManager=require("editor/EditorManager"),HighlightAgent=require("LiveDevelopment/Agents/HighlightAgent"),Inspector=require("LiveDevelopment/Inspector/Inspector"),CSSPreprocessorDocument=function CSSPreprocessorDocument(doc,editor){this.doc=doc,this.onCursorActivity=this.onCursorActivity.bind(this),this.doc.addRef(),this.onActiveEditorChange=this.onActiveEditorChange.bind(this),EditorManager.on("activeEditorChange",this.onActiveEditorChange),this.onActiveEditorChange(null,EditorManager.getActiveEditor(),null)};EventDispatcher.makeEventDispatcher(CSSPreprocessorDocument.prototype),CSSPreprocessorDocument.prototype.close=function close(){this.doc.off(".CSSPreprocessorDocument"),EditorManager.off("activeEditorChange",this.onActiveEditorChange),this.doc.releaseRef(),this.detachFromEditor()},CSSPreprocessorDocument.prototype.isLiveEditingEnabled=function(){return!1},CSSPreprocessorDocument.prototype.attachToEditor=function(editor){this.editor=editor,this.editor&&(this.editor.on("cursorActivity.CSSPreprocessorDocument",this.onCursorActivity),this.updateHighlight())},CSSPreprocessorDocument.prototype.detachFromEditor=function(){this.editor&&(HighlightAgent.hide(),this.editor.off(".CSSPreprocessorDocument"),this.editor=null)},CSSPreprocessorDocument.prototype.updateHighlight=function(){if(Inspector.config.highlight&&this.editor){var editor=this.editor,selectors=[];_.each(this.editor.getSelections(),function(sel){var selector=CSSUtils.findSelectorAtDocumentPos(editor,sel.reversed?sel.end:sel.start);selector&&selectors.push(selector)}),selectors.length?HighlightAgent.rule(selectors.join(",")):HighlightAgent.hide()}},CSSPreprocessorDocument.prototype.onCursorActivity=function onCursorActivity(event,editor){this.updateHighlight()},CSSPreprocessorDocument.prototype.onActiveEditorChange=function(event,newActive,oldActive){this.detachFromEditor(),newActive&&newActive.document===this.doc&&this.attachToEditor(newActive)},module.exports=CSSPreprocessorDocument});
//# sourceMappingURL=CSSPreprocessorDocument.js.map
