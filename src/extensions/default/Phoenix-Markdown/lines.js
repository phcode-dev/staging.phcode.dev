define(function(require,exports,module){var MATCH_NONBLANK=/\S/;function _everySelectionLine(editor,fn){var i,selections=editor.getSelections();for(i=0;i<selections.length;i++){var j,start=selections[i].start.line,end=0===selections[i].end.ch?selections[i].end.line:selections[i].end.line+1;for(j=start;j<end;j++){var line=editor.document.getLine(j);if(MATCH_NONBLANK.test(line)){var state=fn(j,line);if(state&&state.done)return state.result}}}}function _turnLineOn(editor,lineno,line,replaceRE,afterRE,insert){var loc,after=null,replace=replaceRE.exec(line);if(replace){var s=(after=afterRE?afterRE.exec(replace[0]):null)?after[0]:"";loc={line:lineno,ch:replace.index};var endloc={line:lineno,ch:replace.index+replace[0].length};editor.document.replaceRange(s,loc,endloc,"+mdbar"),loc.ch+=s.length}else loc={line:lineno,ch:(after=afterRE?afterRE.exec(line):null)?after.index+after[0].length:0};editor.document.replaceRange(insert,loc,null,"+mdbar")}function _turnLineOff(editor,lineno,found,preserveRE){var preserve=preserveRE?preserveRE.exec(found[0]):null,replace=preserve?preserve[0]:"",loc={line:lineno,ch:found.index},endloc={line:lineno,ch:found.index+found[0].length};editor.document.replaceRange(replace,loc,endloc,"+mdbar")}exports.allLinesOn=function(editor,regExp){if(editor.hasSelection()){var result=_everySelectionLine(editor,function(lineno,line){if(!regExp.test(line))return{done:!0,result:!1}});if(void 0!==result)return result}else{var curLine=editor.getCursorPos(!1,"to").line;if(!regExp.test(editor.document.getLine(curLine)))return!1}return!0},exports.turnLinesOn=function(editor,regexp,replaceRE,afterRE,insert){if(editor.hasSelection())_everySelectionLine(editor,function(lineno,line){regexp.test(line)||_turnLineOn(editor,lineno,line,replaceRE,afterRE,insert)});else{var cursor=editor.getCursorPos(!1,"to"),line=editor.document.getLine(cursor.line);_turnLineOn(editor,cursor.line,line,replaceRE,afterRE,insert)}},exports.turnLinesOff=function(editor,regexp,preserveRE){if(editor.hasSelection())_everySelectionLine(editor,function(lineno,line){var found=regexp.exec(line);found&&_turnLineOff(editor,lineno,found,preserveRE)});else{var cursor=editor.getCursorPos(!1,"to"),found=regexp.exec(editor.document.getLine(cursor.line));found&&_turnLineOff(editor,cursor.line,found,preserveRE)}}});
//# sourceMappingURL=lines.js.map
