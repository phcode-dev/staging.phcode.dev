{"version":3,"sources":["assets/new-project/assets/js/code-editor.js"],"names":["_createRecentProjectCard","projectName","fullPath","nodeId","tabIndex","removeBtnDisableStyle","path","normalize","newProjectExtension","getWelcomeProjectPath","$","_recentProjectMetric","type","Metrics","countEvent","EVENT_TYPE","NEW_PROJECT","getDisplayName","projectPath","prefixRemove","getLocalProjectsPath","getMountDir","prefix","startsWith","replace","DEFAULT_PROJECT_PATH","_updateProjectCards","recentProjectList","document","getElementById","empty","recentProjects","recentProjectExtension","getRecentProjects","defaultProjects","omitProjectsInListing","showRecentProjects","recentProject","includes","append","addClass","openProject","openProjectWithPath","then","closeDialogue","catch","removeProject","removeFromRecentProject","event","stopPropagation","_showFirstTimeExperience","shownBefore","localStorage","getItem","createNotificationFromTemplate","Strings","DEFAULT_PROJECT_NOTIFICATION","allowedPlacements","autoCloseTimeS","dismissOnClick","setItem","initCodeEditor","onclick","openFolder","window","location","href","getExploreProjectPath","newProjectFromURLScreen","getPhoenixAbsURL","NEW_HTML","previewURL"],"mappings":"AA0BA,SAASA,yBAAyBC,YAAaC,SAAUC,OAAQC,UAC7D,IAAIC,sBAAwB,GAI5B,OAHGC,KAAKC,UAAUL,YAAcI,KAAKC,UAAUC,oBAAoBC,2BAC/DJ,sBAAwB,kBAErBK,0BACMP,mHAEGC,4CACYF,uGAEdD,mGAE+CC,mEAC5CG,mvCAiBrB,SAASM,qBAAqBC,MAC1BC,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,yBAA0BJ,MAGjF,SAASK,eAAeC,aACpB,MAAMC,aAAe,CAACX,oBAAoBY,uBAAwBZ,oBAAoBa,eACtF,IAAI,IAAIC,UAAUH,aACd,GAAGD,YAAYK,WAAWD,QACtB,OAAOJ,YAAYM,QAAQF,OAAQ,IAG3C,OAAOJ,YAGX,MAAMO,qBAAuB,4BAE7B,SAASC,sBACL,IAAIC,kBAAoBjB,EAAEkB,SAASC,eAAe,sBAClDF,kBAAkBG,QAClB,IAAIC,eAAiBC,uBAAuBC,oBACxC7B,SAAW,GACX8B,gBAAkB,CAACT,qBAAsB,qBACzCU,sBAAwB,CAAC,qBACzBC,oBAAqB,EACzB,IAAI,IAAIC,iBAAiBN,eACjBG,gBAAgBI,SAASD,iBACzBD,oBAAqB,GAErBD,sBAAsBG,SAASD,gBAC/BV,kBAAkBY,OAAOvC,yBAAyBiB,eAAeoB,eAC7DA,iCAAkCjC,WAAYA,aAGtDgC,oBACA1B,EAAE,4BAA4B8B,SAAS,iBAI/C,SAASC,YAAYvC,UACjB8B,uBAAuBU,oBAAoBxC,UACtCyC,KAAK,KACFnC,oBAAoBoC,kBAEvBC,MAAM,KACHnB,wBAIZ,SAASoB,cAAc5C,UACnB8B,uBAAuBe,wBAAwB7C,UAC/CwB,sBACAsB,MAAMC,kBAGV,SAASC,2BACL,IAAIC,YAAcC,aAAaC,QAAQ,uCAEnCC,+BAA+BC,QAAQC,6BACnC,uBAAwB,CACpBC,kBAAmB,CAAC,OAAQ,SAC5BC,eAAgB,GAChBC,gBAAgB,IAExBP,aAAaQ,QAAQ,oCAAqC,SAIlE,SAASC,iBACLjC,SAASC,eAAe,iBAAiBiC,QAAU,WAC/CjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,eACjER,oBAAoBuD,cAExBnC,SAASC,eAAe,YAAYiC,QAAU,WAC1CjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,YACjEgD,OAAOC,SAASC,KAAO,yBAE3BtC,SAASC,eAAe,oBAAoBiC,QAAU,WAClDjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,kBACjEgD,OAAOC,SAASC,KAAO,2BAE3BtC,SAASC,eAAe,cAAciC,QAAU,WAC5CjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,SACjEyB,YAAYjC,oBAAoB2D,0BAEpCvC,SAASC,eAAe,wBAAwBiC,QAAU,WACtDjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,mBACjEyB,YAAYjC,oBAAoBC,0BAEpCmB,SAASC,eAAe,cAAciC,QAAU,WAC5CjD,QAAQC,WAAWD,QAAQE,WAAWC,YAAa,aAAc,SACjEoD,wBAAwBC,iBAAiB,oCACrC,eAAgBd,QAAQe,SAAU,CAClCC,cAAeF,iBAAiB,gDAExC3C,sBACAwB","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/*global path, newProjectExtension, recentProjectExtension, Strings, Metrics,newProjectFromURLScreen\n,getPhoenixAbsURL, createNotificationFromTemplate*/\n/*eslint no-console: 0*/\n/*eslint strict: [\"error\", \"global\"]*/\n/* jshint ignore:start */\n\nfunction _createRecentProjectCard(projectName, fullPath, nodeId, tabIndex) {\n    let removeBtnDisableStyle = \"\";\n    if(path.normalize(fullPath) === path.normalize(newProjectExtension.getWelcomeProjectPath())){\n        removeBtnDisableStyle = \"display: none;\";\n    }\n    return $(`<li>\n        <a id=\"${nodeId}\" href=\"#\" \n        class=\"d-flex align-items-center justify-content-between tabable\"\n        tabindex=\"${tabIndex}\"\n        onclick=\"openProject('${fullPath}');_recentProjectMetric('open');\">\n            <div class=\"project-name\">\n                ${projectName}\n            </div>\n            <button class=\"remove-btn\" onclick=\"removeProject('${fullPath}');_recentProjectMetric('remove');\"\n            style=\"${removeBtnDisableStyle}\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 14 14\" fill=\"none\"\n                     xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M1.75 3.5H2.91667H12.25\" stroke=\"#D0D0D0\" stroke-linecap=\"round\"\n                          stroke-linejoin=\"round\"/>\n                    <path d=\"M4.6665 3.50008V2.33341C4.6665 2.024 4.78942 1.72725 5.00821 1.50846C5.22701 1.28966 5.52375 1.16675 5.83317 1.16675H8.1665C8.47592 1.16675 8.77267 1.28966 8.99146 1.50846C9.21026 1.72725 9.33317 2.024 9.33317 2.33341V3.50008M11.0832 3.50008V11.6667C11.0832 11.9762 10.9603 12.2729 10.7415 12.4917C10.5227 12.7105 10.2259 12.8334 9.91651 12.8334H4.08317C3.77375 12.8334 3.47701 12.7105 3.25821 12.4917C3.03942 12.2729 2.9165 11.9762 2.9165 11.6667V3.50008H11.0832Z\"\n                          stroke=\"#D0D0D0\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n                    <path d=\"M5.8335 6.41675V9.91675\" stroke=\"#D0D0D0\" stroke-linecap=\"round\"\n                          stroke-linejoin=\"round\"/>\n                    <path d=\"M8.1665 6.41675V9.91675\" stroke=\"#D0D0D0\" stroke-linecap=\"round\"\n                          stroke-linejoin=\"round\"/>\n                </svg>\n            </button>\n        </a>\n    </li>`);\n}\n\nfunction _recentProjectMetric(type) {\n    Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"recentProject.btnClick\", type);\n}\n\nfunction getDisplayName(projectPath) {\n    const prefixRemove = [newProjectExtension.getLocalProjectsPath(), newProjectExtension.getMountDir()];\n    for(let prefix of prefixRemove){\n        if(projectPath.startsWith(prefix)){\n            return projectPath.replace(prefix, '');\n        }\n    }\n    return projectPath;\n}\n\nconst DEFAULT_PROJECT_PATH = '/fs/local/default project';\n\nfunction _updateProjectCards() {\n    let recentProjectList = $(document.getElementById('recentProjectList'));\n    recentProjectList.empty();\n    let recentProjects = recentProjectExtension.getRecentProjects();\n    let tabIndex = 20;\n    let defaultProjects = [DEFAULT_PROJECT_PATH, '/fs/local/explore'],\n        omitProjectsInListing = ['/fs/local/explore'],\n        showRecentProjects = false;\n    for(let recentProject of recentProjects){\n        if(!defaultProjects.includes(recentProject)){\n            showRecentProjects = true;\n        }\n        if(!omitProjectsInListing.includes(recentProject)){\n            recentProjectList.append(_createRecentProjectCard(getDisplayName(recentProject),\n                recentProject, `recent-prj-list-${tabIndex}`, tabIndex++));\n        }\n    }\n    if(!showRecentProjects){\n        $(\"#recentProjectsContainer\").addClass(\"forced-hidden\");\n    }\n}\n\nfunction openProject(fullPath) {\n    recentProjectExtension.openProjectWithPath(fullPath)\n        .then(()=>{\n            newProjectExtension.closeDialogue();\n        })\n        .catch(()=>{\n            _updateProjectCards();\n        });\n}\n\nfunction removeProject(fullPath) {\n    recentProjectExtension.removeFromRecentProject(fullPath);\n    _updateProjectCards();\n    event.stopPropagation();\n}\n\nfunction _showFirstTimeExperience() {\n    let shownBefore = localStorage.getItem('notification.defaultProject.Shown');\n    if(!shownBefore){\n        createNotificationFromTemplate(Strings.DEFAULT_PROJECT_NOTIFICATION,\n            \"defaultProjectButton\", {\n                allowedPlacements: [\"left\", \"right\"],\n                autoCloseTimeS: 15,\n                dismissOnClick: true\n            });\n        localStorage.setItem('notification.defaultProject.Shown', 'true');\n    }\n}\n\nfunction initCodeEditor() {\n    document.getElementById(\"openFolderBtn\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"open-folder\");\n        newProjectExtension.openFolder();\n    };\n    document.getElementById(\"viewMore\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"viewMore\");\n        window.location.href = 'new-project-more.html';\n    };\n    document.getElementById(\"newGitHubProject\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"github-project\");\n        window.location.href = 'new-project-github.html';\n    };\n    document.getElementById(\"exploreBtn\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"games\");\n        openProject(newProjectExtension.getExploreProjectPath());\n    };\n    document.getElementById(\"defaultProjectButton\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"default-project\");\n        openProject(newProjectExtension.getWelcomeProjectPath());\n    };\n    document.getElementById(\"newHTMLBtn\").onclick = function() {\n        Metrics.countEvent(Metrics.EVENT_TYPE.NEW_PROJECT, \"main.Click\", \"html5\");\n        newProjectFromURLScreen(getPhoenixAbsURL(\"assets/sample-projects/HTML5.zip\"),\n            \"html project\", Strings.NEW_HTML, {\n            previewURL: `${getPhoenixAbsURL(\"assets/sample-projects/HTML5/index.html\")}`});\n    };\n    _updateProjectCards();\n    _showFirstTimeExperience();\n}\n"],"file":"code-editor.js"}