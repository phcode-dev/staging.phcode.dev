{"version":3,"sources":["phoenix/shell.js"],"names":["initVFS","ERR_CODES","getBrowserDetails","initTauriShell","_getBaseURL","base","window","location","href","split","endsWith","slice","lastIndexOf","_isTestWindow","isTestPhoenixWindow","URLSearchParams","search","get","isSpecRunnerWindow","pathname","Phoenix","browser","baseURL","isTestWindow","firstBoot","phoenixFirstBoot","startTime","Date","now","app","getNodeState","cbfn","Error","openURLInDefaultBrowser","url","open","getApplicationSupportDirectory","VFS","getAppSupportDir","getUserDocumentsDirectory","getElapsedMilliseconds","language","navigator","appshell","__TAURI__"],"mappings":"OA2BOA,YAAa,uBACbC,cAAe,oBACfC,sBAAuB,6BACvBC,mBAAoB,kBAE3B,SAASC,cAEL,IAAIC,KAAOC,OAAOC,SAASC,KAAKC,MAAM,KAAK,GAO3C,OANGJ,KAAKK,SAAS,WACbL,KAAOA,KAAKM,MAAM,EAAGN,KAAKO,YAAY,OAEtCP,KAAKK,SAAS,OACdL,QAAUA,SAEPA,KAGX,SAASQ,gBACL,MAAMC,sBAAwB,IAAKR,OAAOS,gBAAgBT,OAAOC,SAASS,QAAU,IAAKC,IAAI,mBACvFC,mBAAqBZ,OAAOC,SAASY,SAAST,SAAS,oBAC7D,OAAOI,qBAAuBI,mBAGlC,IAAIE,QAAU,CACVC,QAASnB,oBACToB,QAASlB,cACTmB,aAAcV,gBACdW,UAAWlB,OAAOmB,kBAElBC,UAAYC,KAAKC,MAErBtB,OAAOc,QAAUA,QAEjBpB,UAEAoB,QAAQS,IAAM,CACVC,aAAc,SAAUC,MACpBA,KAAK,IAAIC,MAAM,gDAEnBC,wBAAyB,SAAUC,KAC/B5B,OAAO6B,KAAKD,MAEhBE,+BAAgChB,QAAQiB,IAAIC,iBAC5CC,0BAA2BnB,QAAQiB,IAAIE,0BACvCtC,UAAWA,UACXuC,uBAAwB,WACpB,OAAOb,KAAKC,MAAQF,WAExBe,SAAUC,UAAUD,UAGpBnC,OAAOqC,WACPrC,OAAOqC,SAAWvB,SAGnBd,OAAOsC,WAENzC","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, either version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n// jshint ignore: start\n/*eslint no-console: 0*/\n/*eslint strict: [\"error\", \"global\"]*/\n\n\n/** Setup phoenix shell components\n *\n * This module should be functionally as light weight as possible with minimal deps as it is a shell component.\n * **/\nimport initVFS from \"./init_vfs.js\";\nimport ERR_CODES from \"./errno.js\";\nimport getBrowserDetails from \"./browserDetails.js\";\nimport initTauriShell from \"./tauriShell.js\";\n\nfunction _getBaseURL() {\n    // strip query string\n    let base = window.location.href.split('?')[0];\n    if(base.endsWith(\".html\")){\n        base = base.slice(0, base.lastIndexOf('/'));\n    }\n    if(!base.endsWith(\"/\")){\n        base = `${base}/`;\n    }\n    return base;\n}\n\nfunction _isTestWindow() {\n    const isTestPhoenixWindow = !!(new window.URLSearchParams(window.location.search || \"\")).get(\"testEnvironment\");\n    const isSpecRunnerWindow = window.location.pathname.endsWith(\"/SpecRunner.html\");\n    return isTestPhoenixWindow || isSpecRunnerWindow;\n}\n\nlet Phoenix = {\n    browser: getBrowserDetails(),\n    baseURL: _getBaseURL(),\n    isTestWindow: _isTestWindow(),\n    firstBoot: window.phoenixFirstBoot\n};\nlet startTime = Date.now();\n\nwindow.Phoenix = Phoenix;\n\ninitVFS();\n\nPhoenix.app = {\n    getNodeState: function (cbfn){\n        cbfn(new Error('Node cannot be run in phoenix browser mode'));\n    },\n    openURLInDefaultBrowser: function (url){\n        window.open(url);\n    },\n    getApplicationSupportDirectory: Phoenix.VFS.getAppSupportDir,\n    getUserDocumentsDirectory: Phoenix.VFS.getUserDocumentsDirectory,\n    ERR_CODES: ERR_CODES,\n    getElapsedMilliseconds: function () {\n        return Date.now() - startTime; // milliseconds elapsed since app start\n    },\n    language: navigator.language\n};\n\nif(!window.appshell){\n    window.appshell = Phoenix;\n}\n\nif(window.__TAURI__) {\n    // the __TAURI__ object will be present if we are in a tauri window\n    initTauriShell();\n}\n"],"file":"shell.js"}