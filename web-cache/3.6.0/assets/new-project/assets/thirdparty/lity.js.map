{"version":3,"sources":["assets/new-project/assets/thirdparty/lity.js"],"names":["window","factory","define","amd","$","module","exports","require","lity","jQuery","Zepto","this","document","_win","_deferred","Deferred","_html","_instances","_attrAriaHidden","_dataAriaHidden","_focusableElementsSelector","_defaultOptions","esc","handler","handlers","image","imageHandler","inline","inlineHandler","youtube","youtubeHandler","vimeo","vimeoHandler","googlemaps","googlemapsHandler","facebookvideo","facebookvideoHandler","iframe","iframeHandler","template","_imageRegexp","_youtubeRegex","_vimeoRegex","_googlemapsRegex","_facebookvideoRegex","_transitionEndEvent","el","createElement","transEndEventNames","WebkitTransition","MozTransition","OTransition","transition","name","undefined","style","transitionEnd","element","deferred","length","one","resolve","setTimeout","promise","settings","currSettings","key","value","arguments","extend","parseQueryParams","params","pairs","decodeURI","split","obj","p","i","n","appendQueryParams","url","indexOf","param","transferHash","originalUrl","newUrl","pos","substr","error","msg","append","target","instance","desc","opener","data","img","failed","reject","on","naturalWidth","placeholder","hasHideClass","e","hasClass","before","remove","closest","addClass","removeClass","after","matches","exec","autoplay","output","winHeight","documentElement","clientHeight","Math","round","height","keydown","current","currentInstance","keyCode","options","close","handleTabKey","focusableElements","find","focusedIndex","index","activeElement","shiftKey","get","focus","preventDefault","resize","each","registerInstance","instanceToRegister","unshift","not","attr","removeInstance","instanceToRemove","show","off","grep","oldAttr","removeAttr","removeData","preferredHandler","content","currentHandlers","currentHandler","test","Lity","self","result","isReady","isClosed","ready","css","loader","always","empty","trigger","proxy","contains","add","appendTo","is","when","version"],"mappings":"CAGC,SAASA,OAAQC,SACQ,mBAAXC,QAAyBA,OAAOC,IACvCD,OAAO,CAAC,UAAW,SAASE,GACxB,OAAOH,QAAQD,OAAQI,KAEF,iBAAXC,QAAiD,iBAAnBA,OAAOC,QACnDD,OAAOC,QAAUL,QAAQD,OAAQO,QAAQ,WAEzCP,OAAOQ,KAAOP,QAAQD,OAAQA,OAAOS,QAAUT,OAAOU,OAR9D,CAUoB,oBAAXV,OAAyBA,OAASW,KAAM,SAASX,OAAQI,GAC9D,aAEA,IAAIQ,SAAWZ,OAAOY,SAElBC,KAAOT,EAAEJ,QACTc,UAAYV,EAAEW,SACdC,MAAQZ,EAAE,QACVa,WAAa,GAEbC,gBAAkB,cAClBC,gBAAkB,QAAUD,gBAE5BE,2BAA6B,wLAE7BC,gBAAkB,CAClBC,KAAK,EACLC,QAAS,KACTC,SAAU,CACNC,MAAOC,aACPC,OAAQC,cACRC,QAASC,eACTC,MAAOC,aACPC,WAAYC,kBACZC,cAAeC,qBACfC,OAAQC,eAEZC,SAAU,0ZAGVC,aAAe,uEACfC,cAAgB,uFAChBC,YAAe,+CACfC,iBAAmB,0DACnBC,oBAAsB,0DAEtBC,oBAAsB,WACtB,IAAIC,GAAKlC,SAASmC,cAAc,OAE5BC,mBAAqB,CACrBC,iBAAkB,sBAClBC,cAAe,gBACfC,YAAa,gCACbC,WAAY,iBAGhB,IAAK,IAAIC,QAAQL,mBACb,QAAuBM,IAAnBR,GAAGS,MAAMF,MACT,OAAOL,mBAAmBK,MAIlC,OAAO,EAhBe,GAmB1B,SAASG,cAAcC,SACnB,IAAIC,SAAW5C,YASf,OAPK+B,qBAAwBY,QAAQE,QAGjCF,QAAQG,IAAIf,oBAAqBa,SAASG,SAC1CC,WAAWJ,SAASG,QAAS,MAH7BH,SAASG,UAMNH,SAASK,UAGpB,SAASC,SAASC,aAAcC,IAAKC,OACjC,GAAyB,IAArBC,UAAUT,OACV,OAAOvD,EAAEiE,OAAO,GAAIJ,cAGxB,GAAmB,iBAARC,IAAkB,CACzB,QAAqB,IAAVC,MACP,YAAoC,IAAtBF,aAAaC,KACrB,KACAD,aAAaC,KAGvBD,aAAaC,KAAOC,WAEpB/D,EAAEiE,OAAOJ,aAAcC,KAG3B,OAAOvD,KAGX,SAAS2D,iBAAiBC,QAItB,IAHA,IAAIC,MAAQC,UAAUF,OAAOG,MAAM,KAAK,IAAIA,MAAM,KAC9CC,IAAM,GAAIC,EAELC,EAAI,EAAGC,EAAIN,MAAMb,OAAQkB,EAAIC,EAAGD,IAChCL,MAAMK,KAKXF,KADAC,EAAIJ,MAAMK,GAAGH,MAAM,MACb,IAAME,EAAE,IAGlB,OAAOD,IAGX,SAASI,kBAAkBC,IAAKT,QAC5B,OAAOS,KAAOA,IAAIC,QAAQ,MAAQ,EAAI,IAAM,KAAO7E,EAAE8E,MAAMX,QAG/D,SAASY,aAAaC,YAAaC,QAC/B,IAAIC,IAAMF,YAAYH,QAAQ,KAE9B,OAAK,IAAMK,IACAD,QAGPC,IAAM,IACNF,YAAcA,YAAYG,OAAOD,MAG9BD,OAASD,aAGpB,SAASI,MAAMC,KACX,OAAOrF,EAAE,8BAA8BsF,OAAOD,KAGlD,SAAS/D,aAAaiE,OAAQC,UAC1B,IAAIC,KAAQD,SAASE,UAAYF,SAASE,SAASC,KAAK,cAAiB,4BACrEC,IAAM5F,EAAE,aAAeuF,OAAS,UAAYE,KAAO,OACnDnC,SAAW5C,YACXmF,OAAS,WACTvC,SAASwC,OAAOV,MAAM,0BAc1B,OAXAQ,IACKG,GAAG,OAAQ,WACR,GAA0B,IAAtBxF,KAAKyF,aACL,OAAOH,SAGXvC,SAASG,QAAQmC,OAEpBG,GAAG,QAASF,QAGVvC,SAASK,UAOpB,SAASnC,cAAc+D,OAAQC,UAC3B,IAAI9C,GAAIuD,YAAaC,aAErB,IACIxD,GAAK1C,EAAEuF,QACT,MAAOY,GACL,OAAO,EAGX,QAAKzD,GAAGa,SAIR0C,YAAcjG,EAAE,wCAChBkG,aAAexD,GAAG0D,SAAS,aAE3BZ,SACKnC,UACAG,IAAI,cAAe,WAChByC,YACKI,OAAO3D,IACP4D,SAGDJ,eAAiBxD,GAAG6D,QAAQ,iBAAiBhD,QAC7Cb,GAAG8D,SAAS,eAKjB9D,GACF+D,YAAY,aACZC,MAAMT,cAIf,SAASvE,eAAe6D,QACpB,IAAIoB,QAAUtE,cAAcuE,KAAKrB,QAEjC,QAAKoB,SAIEzE,cACH6C,aACIQ,OACAZ,kBACI,uBAAyBgC,QAAQ,IAAM,IAAM,cAAgBA,QAAQ,GACrE3G,EAAEiE,OACE,CACI4C,SAAU,GAEd3C,iBAAiByC,QAAQ,IAAM,QAOnD,SAAS/E,aAAa2D,QAClB,IAAIoB,QAAUrE,YAAYsE,KAAKrB,QAE/B,QAAKoB,SAIEzE,cACH6C,aACIQ,OACAZ,kBACI,kCAAoCgC,QAAQ,GAC5C3G,EAAEiE,OACE,CACI4C,SAAU,GAEd3C,iBAAiByC,QAAQ,IAAM,QAOnD,SAAS3E,qBAAqBuD,QAC1B,IAAIoB,QAAUnE,oBAAoBoE,KAAKrB,QAEvC,QAAKoB,UAID,IAAMpB,OAAOV,QAAQ,UACrBU,OAAS,SAAWA,QAGjBrD,cACH6C,aACIQ,OACAZ,kBACI,mDAAqDY,OACrDvF,EAAEiE,OACE,CACI4C,SAAU,GAEd3C,iBAAiByC,QAAQ,IAAM,SAOnD,SAAS7E,kBAAkByD,QACvB,IAAIoB,QAAUpE,iBAAiBqE,KAAKrB,QAEpC,QAAKoB,SAIEzE,cACH6C,aACIQ,OACAZ,kBACI,sBAAwBgC,QAAQ,GAAK,SAAWA,QAAQ,GACxD,CACIG,OAAQH,QAAQ,GAAG9B,QAAQ,WAAa,EAAI,UAAY,YAO5E,SAAS3C,cAAcqD,QACnB,MAAO,mFAAqFA,OAAS,YAGzG,SAASwB,YACL,OAAOvG,SAASwG,gBAAgBC,aAC1BzG,SAASwG,gBAAgBC,aACzBC,KAAKC,MAAM1G,KAAK2G,UAG1B,SAASC,QAAQlB,GACb,IAAImB,QAAUC,kBAETD,UAKa,KAAdnB,EAAEqB,SAAoBF,QAAQG,QAAQ,QACtCH,QAAQI,QAIM,IAAdvB,EAAEqB,SACFG,aAAaxB,EAAGmB,UAIxB,SAASK,aAAaxB,EAAGX,UACrB,IAAIoC,kBAAoBpC,SAASnC,UAAUwE,KAAK7G,4BAC5C8G,aAAeF,kBAAkBG,MAAMvH,SAASwH,eAEhD7B,EAAE8B,UAAYH,cAAgB,GAC9BF,kBAAkBM,IAAIN,kBAAkBrE,OAAS,GAAG4E,QACpDhC,EAAEiC,kBACMjC,EAAE8B,UAAYH,eAAiBF,kBAAkBrE,OAAS,IAClEqE,kBAAkBM,IAAI,GAAGC,QACzBhC,EAAEiC,kBAIV,SAASC,SACLrI,EAAEsI,KAAKzH,WAAY,SAAS4D,EAAGe,UAC3BA,SAAS6C,WAIjB,SAASE,iBAAiBC,oBAClB,IAAM3H,WAAW4H,QAAQD,sBACzB5H,MAAM4F,SAAS,eAEf/F,KACKsF,GAAG,CACAsC,OAAQA,OACRhB,QAASA,WAKrBrH,EAAE,YAAY0I,IAAIF,mBAAmBnF,WAChCmD,SAAS,eACT8B,KAAK,WACF,IAAI5F,GAAK1C,EAAEO,WAEP2C,IAAcR,GAAGiD,KAAK5E,kBAI1B2B,GAAGiD,KAAK5E,gBAAiB2B,GAAGiG,KAAK7H,kBAAoB,QAExD6H,KAAK7H,gBAAiB,QAI/B,SAAS8H,eAAeC,kBACpB,IAAIC,KAEJD,iBACKxF,UACAsF,KAAK7H,gBAAiB,QAGvB,IAAMD,WAAW0C,SACjB3C,MAAM6F,YAAY,eAElBhG,KACKsI,IAAI,CACDV,OAAQA,OACRhB,QAASA,YAUjByB,MALJjI,WAAab,EAAEgJ,KAAKnI,WAAY,SAAS2E,UACrC,OAAOqD,mBAAqBrD,YAGfjC,OACN1C,WAAW,GAAGwC,UAEdrD,EAAE,iBAIRyG,YAAY,eACZ6B,KAAK,WACF,IAAI5F,GAAK1C,EAAEO,MAAO0I,QAAUvG,GAAGiD,KAAK5E,iBAE/BkI,QAGDvG,GAAGiG,KAAK7H,gBAAiBmI,SAFzBvG,GAAGwG,WAAWpI,iBAKlB4B,GAAGyG,WAAWpI,mBAK1B,SAASwG,kBACL,OAAI,IAAM1G,WAAW0C,OACV,KAGJ1C,WAAW,GAGtB,SAAShB,QAAQ0F,OAAQC,SAAUpE,SAAUgI,kBACzC,IAAIjI,QAAU,SAAUkI,QAEpBC,gBAAkBtJ,EAAEiE,OAAO,GAAI7C,UAmCnC,OAjCIgI,kBAAoBE,gBAAgBF,mBACpCC,QAAUC,gBAAgBF,kBAAkB7D,OAAQC,UACpDrE,QAAUiI,mBAGVpJ,EAAEsI,KAAK,CAAC,SAAU,UAAW,SAAS7D,EAAGxB,aAC9BqG,gBAAgBrG,MAEvBqG,gBAAgBrG,MAAQ7B,SAAS6B,QAGrCjD,EAAEsI,KAAKgB,gBAAiB,SAASrG,KAAMsG,gBAEnC,OAAKA,oBAKDA,eAAeC,MACdD,eAAeC,KAAKjE,OAAQC,cAO7B,KAFJ6D,QAAUE,eAAehE,OAAQC,YAG7BrE,QAAU8B,MACH,QAFX,OAOD,CAAC9B,QAASA,QAASkI,QAASA,SAAW,IAGlD,SAASI,KAAKlE,OAAQkC,QAAS/B,OAAQsC,eACnC,IAAI0B,KAAOnJ,KACPoJ,OACAC,SAAU,EACVC,UAAW,EACXxG,QACAgG,QAuGJ,SAASS,MAAMH,QACXN,QAAUrJ,EAAE2J,QACPI,IAAI,aAAchD,YAAc,MAGrC1D,QACKwE,KAAK,gBACLS,KAAK,WACF,IAAI0B,OAAShK,EAAEO,MAEf6C,cAAc4G,QACTC,OAAO,WACJD,OAAO1D,aAMvBjD,QACKoD,YAAY,gBACZoB,KAAK,iBACLqC,QACA5E,OAAO+D,SAGZO,SAAU,EAEVP,QACKc,QAAQ,aAAc,CAACT,OAjIhCjC,QAAUzH,EAAEiE,OACR,GACAhD,gBACAwG,SAGJpE,QAAUrD,EAAEyH,QAAQtF,UAIpBuH,KAAKrG,QAAU,WACX,OAAOA,SAGXqG,KAAKhE,OAAS,WACV,OAAOA,QAGXgE,KAAKjC,QAAWzH,EAAEoK,MAAMxG,SAAU8F,KAAMjC,SACxCiC,KAAKtI,SAAWpB,EAAEoK,MAAMxG,SAAU8F,KAAMjC,QAAQrG,UAEhDsI,KAAKrB,OAAS,WACLuB,UAAWC,UAIhBR,QACKU,IAAI,aAAchD,YAAc,MAChCoD,QAAQ,cAAe,CAACT,QAIjCA,KAAKhC,MAAQ,WACT,GAAKkC,UAAWC,SAAhB,CAIAA,UAAW,EAEXjB,eAAec,MAEf,IAAIpG,SAAW5C,YAGf,GACIsH,gBAEIxH,SAASwH,gBAAkB3E,QAAQ,IACnCrD,EAAEqK,SAAShH,QAAQ,GAAI7C,SAASwH,gBAGpC,IACIA,cAAcG,QAChB,MAAOhC,IAsBb,OAhBAkD,QAAQc,QAAQ,aAAc,CAACT,OAE/BrG,QACKoD,YAAY,eACZD,SAAS,eAGdpD,cAAciG,QAAQiB,IAAIjH,UACrB4G,OAAO,WACJZ,QAAQc,QAAQ,cAAe,CAACT,OAChCrG,QAAQiD,SACRjD,aAAUH,EACVI,SAASG,YAIVH,SAASK,YAKpBgG,OAAS9J,QAAQ0F,OAAQmE,KAAMjC,QAAQrG,SAAUqG,QAAQtG,SAEzDkC,QACKsF,KAAK7H,gBAAiB,SACtB0F,SAAS,iCAAmCmD,OAAOxI,SACnDoJ,SAAS,QACTpC,QACApC,GAAG,QAAS,oBAAqB,SAASI,GACnCnG,EAAEmG,EAAEZ,QAAQiF,GAAG,sBACfd,KAAKhC,UAGZyC,QAAQ,YAAa,CAACT,OAG3BnB,iBAAiBmB,MAEjB1J,EAAEyK,KAAKd,OAAON,SACTY,OAAOH,OAoChB,SAAS1J,KAAKmF,OAAQkC,QAAS/B,QACtBH,OAAO6C,gBAGR7C,OAAO6C,iBAEP7C,QADAG,OAAS1F,EAAEO,OACKoF,KAAK,gBAAkBD,OAAOiD,KAAK,SAAWjD,OAAOiD,KAAK,QAJ1EjD,OAAS1F,EAAE0F,QAOf,IAAIF,SAAW,IAAIiE,KACflE,OACAvF,EAAEiE,OACE,GACAyB,OAAOC,KAAK,iBAAmBD,OAAOC,KAAK,QAC3C8B,SAEJ/B,OACAlF,SAASwH,eAGb,IAAKzC,OAAO6C,eACR,OAAO5C,SAWf,OA3dAlE,aAAakI,KAAO,SAASjE,QACzB,OAAOnD,aAAaoH,KAAKjE,SAmd7BnF,KAAKsK,QAAW,QAChBtK,KAAKqH,QAAWzH,EAAEoK,MAAMxG,SAAUxD,KAAMa,iBACxCb,KAAKgB,SAAWpB,EAAEoK,MAAMxG,SAAUxD,KAAMa,gBAAgBG,UACxDhB,KAAKkH,QAAWC,gBAEhBvH,EAAEQ,UAAUuF,GAAG,aAAc,cAAe3F,MAErCA","sourcesContent":["/*! Lity - v2.3.1 - 2018-04-20\n* http://sorgalla.com/lity/\n* Copyright (c) 2015-2018 Jan Sorgalla; Licensed MIT */\n(function(window, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(['jquery'], function($) {\n            return factory(window, $);\n        });\n    } else if (typeof module === 'object' && typeof module.exports === 'object') {\n        module.exports = factory(window, require('jquery'));\n    } else {\n        window.lity = factory(window, window.jQuery || window.Zepto);\n    }\n}(typeof window !== \"undefined\" ? window : this, function(window, $) {\n    'use strict';\n\n    var document = window.document;\n\n    var _win = $(window);\n    var _deferred = $.Deferred;\n    var _html = $('html');\n    var _instances = [];\n\n    var _attrAriaHidden = 'aria-hidden';\n    var _dataAriaHidden = 'lity-' + _attrAriaHidden;\n\n    var _focusableElementsSelector = 'a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^=\"-\"])';\n\n    var _defaultOptions = {\n        esc: true,\n        handler: null,\n        handlers: {\n            image: imageHandler,\n            inline: inlineHandler,\n            youtube: youtubeHandler,\n            vimeo: vimeoHandler,\n            googlemaps: googlemapsHandler,\n            facebookvideo: facebookvideoHandler,\n            iframe: iframeHandler\n        },\n        template: '<div class=\"lity\" role=\"dialog\" aria-label=\"Dialog Window (Press escape to close)\" tabindex=\"-1\"><div class=\"lity-wrap\" data-lity-close role=\"document\"><div class=\"lity-loader\" aria-hidden=\"true\">Loading...</div><div class=\"lity-container\"><div class=\"lity-content\"></div><button class=\"lity-close\" type=\"button\" aria-label=\"Close (Press escape to close)\" data-lity-close>&times;</button></div></div></div>'\n    };\n\n    var _imageRegexp = /(^data:image\\/)|(\\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\\?\\S*)?$)/i;\n    var _youtubeRegex = /(youtube(-nocookie)?\\.com|youtu\\.be)\\/(watch\\?v=|v\\/|u\\/|embed\\/?)?([\\w-]{11})(.*)?/i;\n    var _vimeoRegex =  /(vimeo(pro)?.com)\\/(?:[^\\d]+)?(\\d+)\\??(.*)?$/;\n    var _googlemapsRegex = /((maps|www)\\.)?google\\.([^\\/\\?]+)\\/?((maps\\/?)?\\?)(.*)/i;\n    var _facebookvideoRegex = /(facebook\\.com)\\/([a-z0-9_-]*)\\/videos\\/([0-9]*)(.*)?$/i;\n\n    var _transitionEndEvent = (function() {\n        var el = document.createElement('div');\n\n        var transEndEventNames = {\n            WebkitTransition: 'webkitTransitionEnd',\n            MozTransition: 'transitionend',\n            OTransition: 'oTransitionEnd otransitionend',\n            transition: 'transitionend'\n        };\n\n        for (var name in transEndEventNames) {\n            if (el.style[name] !== undefined) {\n                return transEndEventNames[name];\n            }\n        }\n\n        return false;\n    })();\n\n    function transitionEnd(element) {\n        var deferred = _deferred();\n\n        if (!_transitionEndEvent || !element.length) {\n            deferred.resolve();\n        } else {\n            element.one(_transitionEndEvent, deferred.resolve);\n            setTimeout(deferred.resolve, 500);\n        }\n\n        return deferred.promise();\n    }\n\n    function settings(currSettings, key, value) {\n        if (arguments.length === 1) {\n            return $.extend({}, currSettings);\n        }\n\n        if (typeof key === 'string') {\n            if (typeof value === 'undefined') {\n                return typeof currSettings[key] === 'undefined'\n                    ? null\n                    : currSettings[key];\n            }\n\n            currSettings[key] = value;\n        } else {\n            $.extend(currSettings, key);\n        }\n\n        return this;\n    }\n\n    function parseQueryParams(params) {\n        var pairs = decodeURI(params.split('#')[0]).split('&');\n        var obj = {}, p;\n\n        for (var i = 0, n = pairs.length; i < n; i++) {\n            if (!pairs[i]) {\n                continue;\n            }\n\n            p = pairs[i].split('=');\n            obj[p[0]] = p[1];\n        }\n\n        return obj;\n    }\n\n    function appendQueryParams(url, params) {\n        return url + (url.indexOf('?') > -1 ? '&' : '?') + $.param(params);\n    }\n\n    function transferHash(originalUrl, newUrl) {\n        var pos = originalUrl.indexOf('#');\n\n        if (-1 === pos) {\n            return newUrl;\n        }\n\n        if (pos > 0) {\n            originalUrl = originalUrl.substr(pos);\n        }\n\n        return newUrl + originalUrl;\n    }\n\n    function error(msg) {\n        return $('<span class=\"lity-error\"/>').append(msg);\n    }\n\n    function imageHandler(target, instance) {\n        var desc = (instance.opener() && instance.opener().data('lity-desc')) || 'Image with no description';\n        var img = $('<img src=\"' + target + '\" alt=\"' + desc + '\"/>');\n        var deferred = _deferred();\n        var failed = function() {\n            deferred.reject(error('Failed loading image'));\n        };\n\n        img\n            .on('load', function() {\n                if (this.naturalWidth === 0) {\n                    return failed();\n                }\n\n                deferred.resolve(img);\n            })\n            .on('error', failed)\n        ;\n\n        return deferred.promise();\n    }\n\n    imageHandler.test = function(target) {\n        return _imageRegexp.test(target);\n    };\n\n    function inlineHandler(target, instance) {\n        var el, placeholder, hasHideClass;\n\n        try {\n            el = $(target);\n        } catch (e) {\n            return false;\n        }\n\n        if (!el.length) {\n            return false;\n        }\n\n        placeholder = $('<i style=\"display:none !important\"/>');\n        hasHideClass = el.hasClass('lity-hide');\n\n        instance\n            .element()\n            .one('lity:remove', function() {\n                placeholder\n                    .before(el)\n                    .remove()\n                ;\n\n                if (hasHideClass && !el.closest('.lity-content').length) {\n                    el.addClass('lity-hide');\n                }\n            })\n        ;\n\n        return el\n            .removeClass('lity-hide')\n            .after(placeholder)\n        ;\n    }\n\n    function youtubeHandler(target) {\n        var matches = _youtubeRegex.exec(target);\n\n        if (!matches) {\n            return false;\n        }\n\n        return iframeHandler(\n            transferHash(\n                target,\n                appendQueryParams(\n                    'https://www.youtube' + (matches[2] || '') + '.com/embed/' + matches[4],\n                    $.extend(\n                        {\n                            autoplay: 1\n                        },\n                        parseQueryParams(matches[5] || '')\n                    )\n                )\n            )\n        );\n    }\n\n    function vimeoHandler(target) {\n        var matches = _vimeoRegex.exec(target);\n\n        if (!matches) {\n            return false;\n        }\n\n        return iframeHandler(\n            transferHash(\n                target,\n                appendQueryParams(\n                    'https://player.vimeo.com/video/' + matches[3],\n                    $.extend(\n                        {\n                            autoplay: 1\n                        },\n                        parseQueryParams(matches[4] || '')\n                    )\n                )\n            )\n        );\n    }\n\n    function facebookvideoHandler(target) {\n        var matches = _facebookvideoRegex.exec(target);\n\n        if (!matches) {\n            return false;\n        }\n\n        if (0 !== target.indexOf('http')) {\n            target = 'https:' + target;\n        }\n\n        return iframeHandler(\n            transferHash(\n                target,\n                appendQueryParams(\n                    'https://www.facebook.com/plugins/video.php?href=' + target,\n                    $.extend(\n                        {\n                            autoplay: 1\n                        },\n                        parseQueryParams(matches[4] || '')\n                    )\n                )\n            )\n        );\n    }\n\n    function googlemapsHandler(target) {\n        var matches = _googlemapsRegex.exec(target);\n\n        if (!matches) {\n            return false;\n        }\n\n        return iframeHandler(\n            transferHash(\n                target,\n                appendQueryParams(\n                    'https://www.google.' + matches[3] + '/maps?' + matches[6],\n                    {\n                        output: matches[6].indexOf('layer=c') > 0 ? 'svembed' : 'embed'\n                    }\n                )\n            )\n        );\n    }\n\n    function iframeHandler(target) {\n        return '<div class=\"lity-iframe-container\"><iframe frameborder=\"0\" allowfullscreen src=\"' + target + '\"/></div>';\n    }\n\n    function winHeight() {\n        return document.documentElement.clientHeight\n            ? document.documentElement.clientHeight\n            : Math.round(_win.height());\n    }\n\n    function keydown(e) {\n        var current = currentInstance();\n\n        if (!current) {\n            return;\n        }\n\n        // ESC key\n        if (e.keyCode === 27 && !!current.options('esc')) {\n            current.close();\n        }\n\n        // TAB key\n        if (e.keyCode === 9) {\n            handleTabKey(e, current);\n        }\n    }\n\n    function handleTabKey(e, instance) {\n        var focusableElements = instance.element().find(_focusableElementsSelector);\n        var focusedIndex = focusableElements.index(document.activeElement);\n\n        if (e.shiftKey && focusedIndex <= 0) {\n            focusableElements.get(focusableElements.length - 1).focus();\n            e.preventDefault();\n        } else if (!e.shiftKey && focusedIndex === focusableElements.length - 1) {\n            focusableElements.get(0).focus();\n            e.preventDefault();\n        }\n    }\n\n    function resize() {\n        $.each(_instances, function(i, instance) {\n            instance.resize();\n        });\n    }\n\n    function registerInstance(instanceToRegister) {\n        if (1 === _instances.unshift(instanceToRegister)) {\n            _html.addClass('lity-active');\n\n            _win\n                .on({\n                    resize: resize,\n                    keydown: keydown\n                })\n            ;\n        }\n\n        $('body > *').not(instanceToRegister.element())\n            .addClass('lity-hidden')\n            .each(function() {\n                var el = $(this);\n\n                if (undefined !== el.data(_dataAriaHidden)) {\n                    return;\n                }\n\n                el.data(_dataAriaHidden, el.attr(_attrAriaHidden) || null);\n            })\n            .attr(_attrAriaHidden, 'true')\n        ;\n    }\n\n    function removeInstance(instanceToRemove) {\n        var show;\n\n        instanceToRemove\n            .element()\n            .attr(_attrAriaHidden, 'true')\n        ;\n\n        if (1 === _instances.length) {\n            _html.removeClass('lity-active');\n\n            _win\n                .off({\n                    resize: resize,\n                    keydown: keydown\n                })\n            ;\n        }\n\n        _instances = $.grep(_instances, function(instance) {\n            return instanceToRemove !== instance;\n        });\n\n        if (!!_instances.length) {\n            show = _instances[0].element();\n        } else {\n            show = $('.lity-hidden');\n        }\n\n        show\n            .removeClass('lity-hidden')\n            .each(function() {\n                var el = $(this), oldAttr = el.data(_dataAriaHidden);\n\n                if (!oldAttr) {\n                    el.removeAttr(_attrAriaHidden);\n                } else {\n                    el.attr(_attrAriaHidden, oldAttr);\n                }\n\n                el.removeData(_dataAriaHidden);\n            })\n        ;\n    }\n\n    function currentInstance() {\n        if (0 === _instances.length) {\n            return null;\n        }\n\n        return _instances[0];\n    }\n\n    function factory(target, instance, handlers, preferredHandler) {\n        var handler = 'inline', content;\n\n        var currentHandlers = $.extend({}, handlers);\n\n        if (preferredHandler && currentHandlers[preferredHandler]) {\n            content = currentHandlers[preferredHandler](target, instance);\n            handler = preferredHandler;\n        } else {\n            // Run inline and iframe handlers after all other handlers\n            $.each(['inline', 'iframe'], function(i, name) {\n                delete currentHandlers[name];\n\n                currentHandlers[name] = handlers[name];\n            });\n\n            $.each(currentHandlers, function(name, currentHandler) {\n                // Handler might be \"removed\" by setting callback to null\n                if (!currentHandler) {\n                    return true;\n                }\n\n                if (\n                    currentHandler.test &&\n                    !currentHandler.test(target, instance)\n                ) {\n                    return true;\n                }\n\n                content = currentHandler(target, instance);\n\n                if (false !== content) {\n                    handler = name;\n                    return false;\n                }\n            });\n        }\n\n        return {handler: handler, content: content || ''};\n    }\n\n    function Lity(target, options, opener, activeElement) {\n        var self = this;\n        var result;\n        var isReady = false;\n        var isClosed = false;\n        var element;\n        var content;\n\n        options = $.extend(\n            {},\n            _defaultOptions,\n            options\n        );\n\n        element = $(options.template);\n\n        // -- API --\n\n        self.element = function() {\n            return element;\n        };\n\n        self.opener = function() {\n            return opener;\n        };\n\n        self.options  = $.proxy(settings, self, options);\n        self.handlers = $.proxy(settings, self, options.handlers);\n\n        self.resize = function() {\n            if (!isReady || isClosed) {\n                return;\n            }\n\n            content\n                .css('max-height', winHeight() + 'px')\n                .trigger('lity:resize', [self])\n            ;\n        };\n\n        self.close = function() {\n            if (!isReady || isClosed) {\n                return;\n            }\n\n            isClosed = true;\n\n            removeInstance(self);\n\n            var deferred = _deferred();\n\n            // We return focus only if the current focus is inside this instance\n            if (\n                activeElement &&\n                (\n                    document.activeElement === element[0] ||\n                    $.contains(element[0], document.activeElement)\n                )\n            ) {\n                try {\n                    activeElement.focus();\n                } catch (e) {\n                    // Ignore exceptions, eg. for SVG elements which can't be\n                    // focused in IE11\n                }\n            }\n\n            content.trigger('lity:close', [self]);\n\n            element\n                .removeClass('lity-opened')\n                .addClass('lity-closed')\n            ;\n\n            transitionEnd(content.add(element))\n                .always(function() {\n                    content.trigger('lity:remove', [self]);\n                    element.remove();\n                    element = undefined;\n                    deferred.resolve();\n                })\n            ;\n\n            return deferred.promise();\n        };\n\n        // -- Initialization --\n\n        result = factory(target, self, options.handlers, options.handler);\n\n        element\n            .attr(_attrAriaHidden, 'false')\n            .addClass('lity-loading lity-opened lity-' + result.handler)\n            .appendTo('body')\n            .focus()\n            .on('click', '[data-lity-close]', function(e) {\n                if ($(e.target).is('[data-lity-close]')) {\n                    self.close();\n                }\n            })\n            .trigger('lity:open', [self])\n        ;\n\n        registerInstance(self);\n\n        $.when(result.content)\n            .always(ready)\n        ;\n\n        function ready(result) {\n            content = $(result)\n                .css('max-height', winHeight() + 'px')\n            ;\n\n            element\n                .find('.lity-loader')\n                .each(function() {\n                    var loader = $(this);\n\n                    transitionEnd(loader)\n                        .always(function() {\n                            loader.remove();\n                        })\n                    ;\n                })\n            ;\n\n            element\n                .removeClass('lity-loading')\n                .find('.lity-content')\n                .empty()\n                .append(content)\n            ;\n\n            isReady = true;\n\n            content\n                .trigger('lity:ready', [self])\n            ;\n        }\n    }\n\n    function lity(target, options, opener) {\n        if (!target.preventDefault) {\n            opener = $(opener);\n        } else {\n            target.preventDefault();\n            opener = $(this);\n            target = opener.data('lity-target') || opener.attr('href') || opener.attr('src');\n        }\n\n        var instance = new Lity(\n            target,\n            $.extend(\n                {},\n                opener.data('lity-options') || opener.data('lity'),\n                options\n            ),\n            opener,\n            document.activeElement\n        );\n\n        if (!target.preventDefault) {\n            return instance;\n        }\n    }\n\n    lity.version  = '2.3.1';\n    lity.options  = $.proxy(settings, lity, _defaultOptions);\n    lity.handlers = $.proxy(settings, lity, _defaultOptions.handlers);\n    lity.current  = currentInstance;\n\n    $(document).on('click.lity', '[data-lity]', lity);\n\n    return lity;\n}));\n"],"file":"lity.js"}