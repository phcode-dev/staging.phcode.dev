{"version":3,"sources":["help/HelpCommandHandlers.js"],"names":["define","require","exports","module","AppInit","BuildInfoUtils","CommandManager","Commands","Dialogs","FileUtils","NativeApp","Strings","StringUtils","AboutDialogTemplate","ContributorsTemplate","Mustache","CONTRIBUTORS_PER_PAGE","buildInfo","_handleLinkMenuItem","url","openURLInDefaultBrowser","_handleShowExtensionsFolder","brackets","app","showExtensionsFolder","convertToNativePath","decodeURI","window","location","href","err","_handleAboutDialog","templateVars","ABOUT_ICON","config","about_icon","APP_NAME_ABOUT_BOX","app_name_about","BUILD_TIMESTAMP","build_timestamp","BUILD_INFO","showModalDialogUsingTemplate","render","$dlg","$","$contributors","find","$spinner","contributorsUrl","contributors_url","page","loadContributors","rawUrl","contributors","deferred","Deferred","format","ajax","dataType","cache","done","response","concat","length","resolve","fail","reject","promise","indexOf","addClass","allContributors","totalContributors","contributorsCount","forEach","contributor","avatar_url","split","html","one","this","css","removeClass","each","complete","trigger","appReady","getBracketsSHA","branch","sha","isRepo","substr","trim","register","CMD_HOW_TO_USE_BRACKETS","HELP_HOW_TO_USE_BRACKETS","how_to_use_url","CMD_SUPPORT","HELP_SUPPORT","support_url","CMD_SUGGEST","HELP_SUGGEST","suggest_feature_url","CMD_RELEASE_NOTES","HELP_RELEASE_NOTES","release_notes_url","CMD_GET_INVOLVED","HELP_GET_INVOLVED","get_involved_url","CMD_SHOW_EXTENSIONS_FOLDER","HELP_SHOW_EXT_FOLDER","CMD_HOMEPAGE","HELP_HOMEPAGE","homepage_url","CMD_TWITTER","HELP_TWITTER","twitter_url","CMD_ABOUT","HELP_ABOUT"],"mappings":"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","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2012 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\ndefine(function (require, exports, module) {\n\n\n    var AppInit                 = require(\"utils/AppInit\"),\n        BuildInfoUtils          = require(\"utils/BuildInfoUtils\"),\n        CommandManager          = require(\"command/CommandManager\"),\n        Commands                = require(\"command/Commands\"),\n        Dialogs                 = require(\"widgets/Dialogs\"),\n        FileUtils               = require(\"file/FileUtils\"),\n        NativeApp               = require(\"utils/NativeApp\"),\n        Strings                 = require(\"strings\"),\n        StringUtils             = require(\"utils/StringUtils\"),\n        AboutDialogTemplate     = require(\"text!htmlContent/about-dialog.html\"),\n        ContributorsTemplate    = require(\"text!htmlContent/contributors-list.html\"),\n        Mustache                = require(\"thirdparty/mustache/mustache\");\n    // make sure the global brackets variable is loaded\n    require(\"utils/Global\");\n\n    /**\n     * This is the thirdparty API's (GitHub) maximum contributors per page limit\n     * @const {number}\n     */\n    var CONTRIBUTORS_PER_PAGE   = 100;\n\n    var buildInfo;\n\n\n    function _handleLinkMenuItem(url) {\n        return function () {\n            if (!url) {\n                return;\n            }\n            NativeApp.openURLInDefaultBrowser(url);\n        };\n    }\n\n    function _handleShowExtensionsFolder() {\n        brackets.app.showExtensionsFolder(\n            FileUtils.convertToNativePath(decodeURI(window.location.href)),\n            function (err) {} /* Ignore errors */\n        );\n    }\n\n    function _handleAboutDialog() {\n        var templateVars = {\n            ABOUT_ICON: brackets.config.about_icon,\n            APP_NAME_ABOUT_BOX: brackets.config.app_name_about,\n            BUILD_TIMESTAMP: brackets.config.build_timestamp,\n            BUILD_INFO: buildInfo || \"\",\n            Strings: Strings\n        };\n\n        Dialogs.showModalDialogUsingTemplate(Mustache.render(AboutDialogTemplate, templateVars));\n\n        // Get containers\n        var $dlg            = $(\".about-dialog.instance\"),\n            $contributors   = $dlg.find(\".about-contributors\"),\n            $spinner        = $dlg.find(\".spinner\"),\n            contributorsUrl = brackets.config.contributors_url,\n            page;\n\n        if (contributorsUrl.indexOf(\"{1}\") !== -1) { // pagination enabled\n            page = 1;\n        }\n\n        $spinner.addClass(\"spin\");\n\n        function loadContributors(rawUrl, page, contributors, deferred) {\n            deferred = deferred || new $.Deferred();\n            contributors = contributors || [];\n            var url = StringUtils.format(rawUrl, CONTRIBUTORS_PER_PAGE, page);\n\n            $.ajax({\n                url: url,\n                dataType: \"json\",\n                cache: false\n            })\n                .done(function (response) {\n                    contributors = contributors.concat(response || []);\n                    if (page && response.length === CONTRIBUTORS_PER_PAGE) {\n                        loadContributors(rawUrl, page + 1, contributors, deferred);\n                    } else {\n                        deferred.resolve(contributors);\n                    }\n                })\n                .fail(function () {\n                    if (contributors.length) { // we weren't able to fetch this page, but previous fetches were successful\n                        deferred.resolve(contributors);\n                    } else {\n                        deferred.reject();\n                    }\n                });\n            return deferred.promise();\n        }\n\n        loadContributors(contributorsUrl, page) // Load the contributors\n            .done(function (allContributors) {\n                // Populate the contributors data\n                var totalContributors = allContributors.length,\n                    contributorsCount = 0;\n\n                allContributors.forEach(function (contributor) {\n                    // remove any UrlParams delivered via the GitHub API\n                    contributor.avatar_url = contributor.avatar_url.split(\"?\")[0];\n                });\n\n                $contributors.html(Mustache.render(ContributorsTemplate, allContributors));\n\n                // This is used to create an opacity transition when each image is loaded\n                $contributors.find(\"img\").one(\"load\", function () {\n                    $(this).css(\"opacity\", 1);\n\n                    // Count the contributors loaded and hide the spinner once all are loaded\n                    contributorsCount++;\n                    if (contributorsCount >= totalContributors) {\n                        $spinner.removeClass(\"spin\");\n                    }\n                }).each(function () {\n                    if (this.complete) {\n                        $(this).trigger(\"load\");\n                    }\n                });\n            })\n            .fail(function () {\n                $spinner.removeClass(\"spin\");\n                $contributors.html(Mustache.render(\"<p class='dialog-message'>{{ABOUT_TEXT_LINE6}}</p>\", Strings));\n            });\n    }\n\n    // Read \"build number\" SHAs off disk immediately at APP_READY, instead\n    // of later, when they may have been updated to a different version\n    AppInit.appReady(function () {\n        BuildInfoUtils.getBracketsSHA().done(function (branch, sha, isRepo) {\n            // If we've successfully determined a \"build number\" via .git metadata, add it to dialog\n            sha = sha ? sha.substr(0, 9) : \"\";\n            if (branch || sha) {\n                buildInfo = StringUtils.format(\"({0} {1})\", branch, sha).trim();\n            }\n        });\n    });\n\n    CommandManager.register(Strings.CMD_HOW_TO_USE_BRACKETS,    Commands.HELP_HOW_TO_USE_BRACKETS,  _handleLinkMenuItem(brackets.config.how_to_use_url));\n    CommandManager.register(Strings.CMD_SUPPORT,                Commands.HELP_SUPPORT,              _handleLinkMenuItem(brackets.config.support_url));\n    CommandManager.register(Strings.CMD_SUGGEST,                Commands.HELP_SUGGEST,              _handleLinkMenuItem(brackets.config.suggest_feature_url));\n    CommandManager.register(Strings.CMD_RELEASE_NOTES,          Commands.HELP_RELEASE_NOTES,        _handleLinkMenuItem(brackets.config.release_notes_url));\n    CommandManager.register(Strings.CMD_GET_INVOLVED,           Commands.HELP_GET_INVOLVED,         _handleLinkMenuItem(brackets.config.get_involved_url));\n    CommandManager.register(Strings.CMD_SHOW_EXTENSIONS_FOLDER, Commands.HELP_SHOW_EXT_FOLDER,      _handleShowExtensionsFolder);\n    CommandManager.register(Strings.CMD_HOMEPAGE,               Commands.HELP_HOMEPAGE,             _handleLinkMenuItem(brackets.config.homepage_url));\n    CommandManager.register(Strings.CMD_TWITTER,                Commands.HELP_TWITTER,              _handleLinkMenuItem(brackets.config.twitter_url));\n    CommandManager.register(Strings.CMD_ABOUT,                  Commands.HELP_ABOUT,                _handleAboutDialog);\n});\n"],"file":"HelpCommandHandlers.js"}