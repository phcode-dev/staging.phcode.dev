{"version":3,"sources":["thirdparty/CodeMirror/addon/display/placeholder.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","clearPlaceholder","cm","state","placeholder","parentNode","removeChild","setPlaceholder","elt","document","createElement","style","cssText","direction","getOption","className","placeHolder","createTextNode","appendChild","display","lineSpace","insertBefore","firstChild","onComposition","setTimeout","empty","lineCount","input","getInputField","nodeName","getLine","length","test","querySelector","textContent","onBlur","isEmpty","onChange","wrapper","getWrapperElement","replace","defineOption","val","old","prev","Init","on","placeholderCompose","off","hasFocus"],"mappings":"CAGA,SAAUA,KACc,iBAAXC,SAAwC,iBAAVC,OACvCF,IAAIG,QAAQ,yBACY,mBAAVC,QAAwBA,OAAOC,IAC7CD,OAAO,CAAC,wBAAyBJ,KAEjCA,IAAIM,YANR,CAOG,SAASA,YAsBV,SAASC,iBAAiBC,IACpBA,GAAGC,MAAMC,cACXF,GAAGC,MAAMC,YAAYC,WAAWC,YAAYJ,GAAGC,MAAMC,aACrDF,GAAGC,MAAMC,YAAc,MAG3B,SAASG,eAAeL,IACtBD,iBAAiBC,IACjB,IAAIM,IAAMN,GAAGC,MAAMC,YAAcK,SAASC,cAAc,OACxDF,IAAIG,MAAMC,QAAU,+BACpBJ,IAAIG,MAAME,UAAYX,GAAGY,UAAU,aACnCN,IAAIO,UAAY,8CAChB,IAAIC,YAAcd,GAAGY,UAAU,eACL,iBAAfE,cAAyBA,YAAcP,SAASQ,eAAeD,cAC1ER,IAAIU,YAAYF,aAChBd,GAAGiB,QAAQC,UAAUC,aAAab,IAAKN,GAAGiB,QAAQC,UAAUE,YAG9D,SAASC,cAAcrB,IACrBsB,WAAW,WACT,IAAIC,OAAQ,EACZ,GAAsB,GAAlBvB,GAAGwB,YAAkB,CACvB,IAAIC,MAAQzB,GAAG0B,gBACfH,MAA0B,YAAlBE,MAAME,UAA0B3B,GAAG4B,QAAQ,GAAGC,QACjD,YAAYC,KAAKL,MAAMM,cAAc,oBAAoBC,aAE5DT,MAAOlB,eAAeL,IACrBD,iBAAiBC,KACrB,IAGL,SAASiC,OAAOjC,IACVkC,QAAQlC,KAAKK,eAAeL,IAElC,SAASmC,SAASnC,IAChB,IAAIoC,QAAUpC,GAAGqC,oBAAqBd,MAAQW,QAAQlC,IACtDoC,QAAQvB,UAAYuB,QAAQvB,UAAUyB,QAAQ,oBAAqB,KAAOf,MAAQ,oBAAsB,IAEpGA,MAAOlB,eAAeL,IACrBD,iBAAiBC,IAGxB,SAASkC,QAAQlC,IACf,OAA2B,IAAnBA,GAAGwB,aAAyC,KAAlBxB,GAAG4B,QAAQ,GAhE/C9B,WAAWyC,aAAa,cAAe,GAAI,SAASvC,GAAIwC,IAAKC,KAC3D,IAAIC,KAAOD,KAAOA,KAAO3C,WAAW6C,KACpC,GAAIH,MAAQE,KACV1C,GAAG4C,GAAG,OAAQX,QACdjC,GAAG4C,GAAG,SAAUT,UAChBnC,GAAG4C,GAAG,UAAWT,UACjBrC,WAAW8C,GAAG5C,GAAG0B,gBAAiB,oBAAqB1B,GAAGC,MAAM4C,mBAAqB,WAAaxB,cAAcrB,MAChHmC,SAASnC,SACJ,IAAKwC,KAAOE,KAAM,CACvB1C,GAAG8C,IAAI,OAAQb,QACfjC,GAAG8C,IAAI,SAAUX,UACjBnC,GAAG8C,IAAI,UAAWX,UAClBrC,WAAWgD,IAAI9C,GAAG0B,gBAAiB,oBAAqB1B,GAAGC,MAAM4C,oBACjE9C,iBAAiBC,IACjB,IAAIoC,QAAUpC,GAAGqC,oBACjBD,QAAQvB,UAAYuB,QAAQvB,UAAUyB,QAAQ,oBAAqB,IAGjEE,MAAQxC,GAAG+C,YAAYd,OAAOjC","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  CodeMirror.defineOption(\"placeholder\", \"\", function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.on(\"blur\", onBlur);\n      cm.on(\"change\", onChange);\n      cm.on(\"swapDoc\", onChange);\n      CodeMirror.on(cm.getInputField(), \"compositionupdate\", cm.state.placeholderCompose = function() { onComposition(cm) })\n      onChange(cm);\n    } else if (!val && prev) {\n      cm.off(\"blur\", onBlur);\n      cm.off(\"change\", onChange);\n      cm.off(\"swapDoc\", onChange);\n      CodeMirror.off(cm.getInputField(), \"compositionupdate\", cm.state.placeholderCompose)\n      clearPlaceholder(cm);\n      var wrapper = cm.getWrapperElement();\n      wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\");\n    }\n\n    if (val && !cm.hasFocus()) onBlur(cm);\n  });\n\n  function clearPlaceholder(cm) {\n    if (cm.state.placeholder) {\n      cm.state.placeholder.parentNode.removeChild(cm.state.placeholder);\n      cm.state.placeholder = null;\n    }\n  }\n  function setPlaceholder(cm) {\n    clearPlaceholder(cm);\n    var elt = cm.state.placeholder = document.createElement(\"pre\");\n    elt.style.cssText = \"height: 0; overflow: visible\";\n    elt.style.direction = cm.getOption(\"direction\");\n    elt.className = \"CodeMirror-placeholder CodeMirror-line-like\";\n    var placeHolder = cm.getOption(\"placeholder\")\n    if (typeof placeHolder == \"string\") placeHolder = document.createTextNode(placeHolder)\n    elt.appendChild(placeHolder)\n    cm.display.lineSpace.insertBefore(elt, cm.display.lineSpace.firstChild);\n  }\n\n  function onComposition(cm) {\n    setTimeout(function() {\n      var empty = false\n      if (cm.lineCount() == 1) {\n        var input = cm.getInputField()\n        empty = input.nodeName == \"TEXTAREA\" ? !cm.getLine(0).length\n          : !/[^\\u200b]/.test(input.querySelector(\".CodeMirror-line\").textContent)\n      }\n      if (empty) setPlaceholder(cm)\n      else clearPlaceholder(cm)\n    }, 20)\n  }\n\n  function onBlur(cm) {\n    if (isEmpty(cm)) setPlaceholder(cm);\n  }\n  function onChange(cm) {\n    var wrapper = cm.getWrapperElement(), empty = isEmpty(cm);\n    wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\") + (empty ? \" CodeMirror-empty\" : \"\");\n\n    if (empty) setPlaceholder(cm);\n    else clearPlaceholder(cm);\n  }\n\n  function isEmpty(cm) {\n    return (cm.lineCount() === 1) && (cm.getLine(0) === \"\");\n  }\n});\n"],"file":"placeholder.js"}