define(function(require,exports,module){const serverSync=require("serverSync"),newProject=require("new-project"),defaultProjects=require("default-projects"),newFeature=require("newly-added-features"),AppInit=brackets.getModule("utils/AppInit"),Strings=brackets.getModule("strings"),Dialogs=brackets.getModule("widgets/Dialogs"),Mustache=brackets.getModule("thirdparty/mustache/mustache"),DefaultDialogs=brackets.getModule("widgets/DefaultDialogs"),unSupportedBrowserTemplate=require("text!html/unsupported-browser.html"),PERSIST_STORAGE_DIALOG_DELAY_SECS=6e4;let $icon,unsupportedBrowserDialogShown;function _addToolbarIcon(){const helpButtonID="help-button";($icon=$("<a>").attr({id:helpButtonID,href:"#",class:"help",title:Strings.CMD_SUPPORT}).appendTo($("#main-toolbar .bottom-buttons"))).on("click",()=>{window.open(brackets.config.support_url)})}function _showUnSupportedBrowserDialogue(){if(unsupportedBrowserDialogShown||Phoenix.isTestWindow)return;if(unsupportedBrowserDialogShown=!0,Phoenix.browser.isMobile||Phoenix.browser.isTablet)return void Dialogs.showModalDialog(DefaultDialogs.DIALOG_ID_ERROR,Strings.UNSUPPORTED_BROWSER,Strings.UNSUPPORTED_BROWSER_MOBILE);let templateVars={Strings:Strings,surveyURL:"https://s.surveyplanet.com/6208d1eccd51c561fc8e59ca"};Dialogs.showModalDialogUsingTemplate(Mustache.render(unSupportedBrowserTemplate,templateVars))}function _detectUnSupportedBrowser(){Phoenix.isSupportedBrowser||_showUnSupportedBrowserDialogue()}async function _persistBrowserStorage(){if(navigator.storage&&navigator.storage.persist){let isPersisted=await navigator.storage.persisted();console.log(`Browser Persisted storage granted?: ${isPersisted}`),setTimeout(async()=>{isPersisted||(console.log("Browser Persisted storage requesting"),isPersisted=await navigator.storage.persist(),console.log(`Browser Persisted storage granted?: ${isPersisted}`))},PERSIST_STORAGE_DIALOG_DELAY_SECS)}else console.error("Browser does not support storage persistence APIs"),_showUnSupportedBrowserDialogue()}AppInit.appReady(function(){_addToolbarIcon(),serverSync.init(),defaultProjects.init(),newProject.init(),newFeature.init(),_detectUnSupportedBrowser(),_persistBrowserStorage()})});
//# sourceMappingURL=main.js.map
