define(function(require,exports,module){var Strings=brackets.getModule("strings"),StringUtils=brackets.getModule("utils/StringUtils"),AnimationUtils=brackets.getModule("utils/AnimationUtils"),BEZIER_CURVE_VALID_REGEX=/cubic-bezier\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/,BEZIER_CURVE_GENERAL_REGEX=/cubic-bezier\((.*)\)/,EASE_STRICT_REGEX=/[: ,]ease(?:-in)?(?:-out)?[ ,;]/,EASE_LAX_REGEX=/ease(?:-in)?(?:-out)?/,LINEAR_STRICT_REGEX=/(transition|animation).*?[: ,]linear[ ,;]/,LINEAR_LAX_REGEX=/linear/,STEPS_VALID_REGEX=/steps\(\s*(\d+)\s*(?:,\s*(\w+)\s*)?\)/,STEPS_GENERAL_REGEX=/steps\((.*)\)/,STEP_STRICT_REGEX=/[: ,](?:step-start|step-end)[ ,;]/,STEP_LAX_REGEX=/step-start|step-end/,BEZIER=1,STEP=2;function _convertToNumber(str){if("string"!=typeof str)return{isNumber:!1,value:null};var val=parseFloat(+str,10),isNum;return{isNumber:"number"==typeof val&&!isNaN(val)&&val!==1/0&&val!==-1/0,value:val}}function _getValidBezierParams(match){var param,def=[".42","0",".58","1"],oldIndex=match.index,originalString=match[0],i;if(match&&(match=match[1].split(",")),match)for(i=0;i<=3;i++)match[i]&&(match[i]=match[i].trim(),(param=_convertToNumber(match[i])).isNumber?0!==i&&2!==i||(param.value<0?match[i]="0":param.value>1&&(match[i]="1")):match[i]=void 0),match[i]||(match[i]=def[i]);else match=def;return(match=(match="cubic-bezier("+(match=match.splice(0,4)).join(", ")+")").match(BEZIER_CURVE_VALID_REGEX))?(match.index=oldIndex,match.originalString=originalString,match):null}function _validateCubicBezierParams(match){var x1=_convertToNumber(match[1]),y1=_convertToNumber(match[2]),x2=_convertToNumber(match[3]),y2=_convertToNumber(match[4]);return!!(x1.isNumber&&y1.isNumber&&x2.isNumber&&y2.isNumber)&&!(x1.value<0||x1.value>1||x2.value<0||x2.value>1)}function _getValidStepsParams(match){var param,def=["5","end"],params=def,oldIndex=match.index,originalString=match[0];return match&&(match=match[1].split(",")),match&&(match[0]&&((param=_convertToNumber(param=match[0].replace(/[\s\"']/g,""))).isNumber?param.value&&(param.value=Math.floor(param.value)):param.value=def[0],param.value<1&&(param.value=def[0]),params[0]=param.value),match[1]&&(param=(param=match[1].replace(/[\s\"']/g,"")).substr(0,1),params[1]="s"===param?"start":"end")),(params=(params="steps("+params.join(", ")+")").match(STEPS_VALID_REGEX))?(params.index=oldIndex,params.originalString=originalString,params):null}function _validateStepsParams(match){var count=_convertToNumber(match[1]);return!(!count.isNumber||count.value<1||Math.floor(count.value)!==count.value)&&(!match[2]||"start"===match[2]||"end"===match[2])}function showHideHint(hint,show,documentCode,editorCode){hint&&hint.elem&&(show?(hint.shown=!0,hint.animationInProgress=!1,hint.elem.removeClass("fadeout"),hint.elem.html(StringUtils.format(Strings.INLINE_TIMING_EDITOR_INVALID,documentCode,editorCode)),hint.elem.css("display","block")):hint.shown?(hint.animationInProgress=!0,AnimationUtils.animateUsingClass(hint.elem[0],"fadeout",750).done(function(){hint.animationInProgress&&hint.elem.hide(),hint.shown=!1,hint.animationInProgress=!1})):hint.elem.hide())}function _tagMatch(match,type){switch(type){case BEZIER:match.isBezier=!0;break;case STEP:match.isStep=!0}return match}function bezierCurveMatch(str,lax){var match;if((match=str.match(BEZIER_CURVE_VALID_REGEX))&&_validateCubicBezierParams(match))return _tagMatch(match,BEZIER);if(match=str.match(BEZIER_CURVE_GENERAL_REGEX)){if((match=_getValidBezierParams(match))&&_validateCubicBezierParams(match))return _tagMatch(match,BEZIER);window.console.log("brackets-cubic-bezier: TimingFunctionUtils._getValidBezierParams created invalid code")}if(lax){if(match=str.match(EASE_LAX_REGEX))return _tagMatch(match,BEZIER)}else if(match=str.match(EASE_STRICT_REGEX))return _tagMatch(str.match(EASE_LAX_REGEX),BEZIER);if(lax){if(match=str.match(LINEAR_LAX_REGEX))return _tagMatch(match,BEZIER)}else if(match=str.match(LINEAR_STRICT_REGEX))return _tagMatch(str.match(LINEAR_LAX_REGEX),BEZIER);return null}function stepsMatch(str,lax){var match;if((match=str.match(STEPS_VALID_REGEX))&&_validateStepsParams(match))return _tagMatch(match,STEP);if(match=str.match(STEPS_GENERAL_REGEX)){if((match=_getValidStepsParams(match))&&_validateStepsParams(match))return _tagMatch(match,STEP);window.console.log("brackets-steps: TimingFunctionUtils._getValidStepsParams created invalid code")}if(lax){if(match=str.match(STEP_LAX_REGEX))return _tagMatch(match,STEP)}else if(match=str.match(STEP_STRICT_REGEX))return _tagMatch(str.match(STEP_LAX_REGEX),STEP);return null}function timingFunctionMatch(str,lax){return bezierCurveMatch(str,lax)||stepsMatch(str,lax)}exports.timingFunctionMatch=timingFunctionMatch,exports.bezierCurveMatch=bezierCurveMatch,exports.stepsMatch=stepsMatch,exports.showHideHint=showHideHint});
//# sourceMappingURL=TimingFunctionUtils.js.map
