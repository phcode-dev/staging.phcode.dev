{"version":3,"sources":["extensions/default/QuickView/unittests.js"],"names":["define","require","exports","module","SpecRunnerUtils","brackets","getModule","PreferencesManager","prefs","getExtensionPrefs","describe","testFolder","getTestPath","testWindow","CommandManager","Commands","EditorManager","QuickView","editor","testFile","oldFile","async","getPopoverAtPos","lineNum","columnNum","cm","getCurrentFullEditor","_codeMirror","pos","line","ch","token","setCursorPos","getTokenAt","_queryPreviewProviders","expectNoPreviewAtPos","popoverInfo","expect","toBeFalsy","checkColorAtPos","expectedColor","content","find","attr","toBe","checkGradientAtPos","expectedGradient","checkImagePathAtPos","expectedPathEnding","imagePath","substr","length","checkImageDataAtPos","expectedData","beforeEach","createTestWindowAndRun","loadProjectInTestWindow","test","QuickViewManager","awaitsForDone","openProjectFiles","afterAll","closeTestWindow","it","expectedGradient1","expectedGradient2","expectedGradient3","expectedGradient4","original","get","set"],"mappings":"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","sourcesContent":["/*\n * GNU AGPL-3.0 License\n *\n * Copyright (c) 2021 - present core.ai . All rights reserved.\n * Original work Copyright (c) 2013 - 2021 Adobe Systems Incorporated. All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License\n * for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see https://opensource.org/licenses/AGPL-3.0.\n *\n */\n\n/*global describe, it, expect, beforeEach, awaitsForDone, afterAll */\n\ndefine(function (require, exports, module) {\n\n\n    var SpecRunnerUtils    = brackets.getModule(\"spec/SpecRunnerUtils\"),\n        PreferencesManager = brackets.getModule(\"preferences/PreferencesManager\"),\n        prefs              = PreferencesManager.getExtensionPrefs(\"quickview\");\n\n    describe(\"extension:Quick View\", function () {\n        let testFolder = SpecRunnerUtils.getTestPath(\"/spec/quickview-extn-test-files\");\n\n        // load from testWindow\n        var testWindow,\n            brackets,\n            CommandManager,\n            Commands,\n            EditorManager,\n            QuickView,\n            editor,\n            testFile = \"test.css\",\n            oldFile;\n\n        beforeEach(async function () {\n            // Create a new window that will be shared by ALL tests in this spec.\n            if (!testWindow) {\n                testWindow = await SpecRunnerUtils.createTestWindowAndRun();\n\n                await SpecRunnerUtils.loadProjectInTestWindow(testFolder);\n            }\n\n            // Load module instances from brackets.test\n            brackets = testWindow.brackets;\n            CommandManager = brackets.test.CommandManager;\n            Commands = brackets.test.Commands;\n            EditorManager = brackets.test.EditorManager;\n            QuickView = brackets.test.QuickViewManager;\n\n            if (testFile !== oldFile) {\n                await awaitsForDone(SpecRunnerUtils.openProjectFiles([testFile]), \"open test file: \" + testFile);\n\n                editor  = EditorManager.getCurrentFullEditor();\n                oldFile = testFile;\n            }\n        }, 30000);\n\n        afterAll(async function () {\n            testWindow       = null;\n            brackets         = null;\n            CommandManager   = null;\n            Commands         = null;\n            EditorManager    = null;\n            QuickView        = null;\n            await SpecRunnerUtils.closeTestWindow();\n        });\n\n        async function getPopoverAtPos(lineNum, columnNum) {\n            editor  = EditorManager.getCurrentFullEditor();\n            var cm = editor._codeMirror,\n                pos = { line: lineNum, ch: columnNum },\n                token;\n\n            editor.setCursorPos(pos);\n            token = cm.getTokenAt(pos, true);\n\n            return QuickView._queryPreviewProviders(editor, pos, token);\n        }\n\n        async function expectNoPreviewAtPos(line, ch) {\n            var popoverInfo = await getPopoverAtPos(line, ch);\n            expect(popoverInfo).toBeFalsy();\n        }\n\n        async function checkColorAtPos(expectedColor, line, ch) {\n            var popoverInfo = await getPopoverAtPos(line, ch);\n            expect(popoverInfo.content.find(\"#quick-view-color-swatch\").attr(\"data-for-test\")).toBe(expectedColor);\n        }\n\n        async function checkGradientAtPos(expectedGradient, line, ch) {\n            // Just call await checkColorAtPos since both have the same function calls.\n            await checkColorAtPos(expectedGradient, line, ch);\n        }\n\n        async function checkImagePathAtPos(expectedPathEnding, line, ch) {\n            var popoverInfo = await getPopoverAtPos(line, ch),\n                imagePath = popoverInfo.content.find(\"#quick-view-image-preview\").attr(\"data-for-test\");\n\n            // Just check end of path - local drive location prefix unimportant\n            expect(imagePath.substr(imagePath.length - expectedPathEnding.length)).toBe(expectedPathEnding);\n        }\n\n        async function checkImageDataAtPos(expectedData, line, ch) {\n            var popoverInfo = await getPopoverAtPos(line, ch),\n                imagePath = popoverInfo.content.find(\"#quick-view-image-preview\").attr(\"data-for-test\");\n            expect(imagePath).toBe(expectedData);\n        }\n\n        describe(\"Quick view colors\", function () {\n            it(\"should show preview of hex colors either in 3 digit hex or or 6-digit hex\",async function () {\n                await checkColorAtPos(\"#369\", 3, 12);\n                await checkColorAtPos(\"#2491F5\", 4, 13);\n            });\n\n            it(\"should NOT show preview of color on words start with #\",async function () {\n                await expectNoPreviewAtPos(7, 7);     // cursor on #invalid_hex\n                await expectNoPreviewAtPos(8, 15);    // cursor on #web\n            });\n\n            it(\"should show preview of valid rgb/rgba colors\",async function () {\n                await checkColorAtPos(\"rgb(255,0,0)\",           12, 12);  // no whitespace\n                await checkColorAtPos(\"rgb(100%,   0%,   0%)\",  13, 17);  // extra whitespace\n                await checkColorAtPos(\"rgb(50%, 75%, 25%)\",     14, 24);\n\n                // rgba with values of 0-255\n                await checkColorAtPos(\"rgba(255, 0, 0, 0.5)\", 15, 23);\n                await checkColorAtPos(\"rgba(255, 0, 0, 1)\",   16, 22);\n                await checkColorAtPos(\"rgba(255, 0, 0, .5)\",  17, 19);\n\n                // rgba with percentage values\n                await checkColorAtPos(\"rgba(100%, 0%, 0%, 0.5)\",  18, 32);\n                await checkColorAtPos(\"rgba(80%, 50%, 50%, 1)\",   20, 33);\n                await checkColorAtPos(\"rgba(50%, 75%, 25%, 1.0)\", 21, 23);\n            });\n\n            it(\"should NOT show preview of unsupported rgb/rgba colors\",async function () {\n                await expectNoPreviewAtPos(25, 14);    // cursor on rgb(300, 0, 0)\n                await expectNoPreviewAtPos(26, 15);    // cursor on rgb(0, 95.5, 0)\n                await expectNoPreviewAtPos(27, 15);    // cursor on rgba(-0, 0, 0, 0.5)\n            });\n\n            it(\"should show preview of valid hsl/hsla colors\",async function () {\n                await checkColorAtPos(\"hsl(0, 100%, 50%)\",       31, 22);\n                await checkColorAtPos(\"hsla(0, 100%, 50%, 0.5)\", 32, 23);\n                await checkColorAtPos(\"hsla(0, 100%, 50%, .5)\",  33, 23);\n                await checkColorAtPos(\"hsl(390, 100%, 50%)\",     34, 24);\n            });\n\n            it(\"should NOT show preview of unsupported hsl/hsla colors\",async function () {\n                await expectNoPreviewAtPos(38, 25);    // cursor on hsla(90, 100%, 50%, 2)\n                await expectNoPreviewAtPos(39, 24);    // cursor on hsla(0, 200%, 50%, 0.5)\n                await expectNoPreviewAtPos(40, 25);    // cursor on hsla(0.0, 100%, 50%, .5)\n            });\n\n            it(\"should show preview of colors with valid names\", async function () {\n                await checkColorAtPos(\"blueviolet\",    47, 15);\n                await checkColorAtPos(\"darkgoldenrod\", 49, 16);\n                await checkColorAtPos(\"darkgray\",      50, 16);\n                await checkColorAtPos(\"firebrick\",     51, 15);\n                await checkColorAtPos(\"honeydew\",      53, 16);\n                await checkColorAtPos(\"lavenderblush\", 56, 16);\n                await checkColorAtPos(\"salmon\",        61, 16);\n                await checkColorAtPos(\"tomato\",        66, 16);\n            });\n\n            it(\"should NOT show preview of colors with invalid names\", async function () {\n                await expectNoPreviewAtPos(72, 15);    // cursor on redsox\n                await expectNoPreviewAtPos(73, 16);    // cursor on pinky\n                await expectNoPreviewAtPos(74, 16);    // cursor on blue in hyphenated word blue-cheese\n                await expectNoPreviewAtPos(75, 18);    // cursor on white in hyphenated word @bc-bg-highlight\n            });\n\n            describe(\"JavaScript file\", function () {\n                testFile = \"test.js\";\n\n                it(\"should NOT show preview of color-named functions and object/array keys\", async function () {\n                    await expectNoPreviewAtPos(2, 12);    // cursor on green()\n                    await expectNoPreviewAtPos(4, 22);    // cursor on Math.tan\n                    await expectNoPreviewAtPos(5, 14);    // cursor on tan()\n                    await expectNoPreviewAtPos(5, 38);    // cursor on array[red]\n                });\n                it(\"should not show preview of literal color names\", async function () {\n                    await expectNoPreviewAtPos(2, 36);  // green\n                    await expectNoPreviewAtPos(3, 21);  // green\n                    await expectNoPreviewAtPos(5, 25);  // red\n                    await expectNoPreviewAtPos(7,  1);  // darkgray\n                });\n            });\n        });\n\n        describe(\"Quick view gradients\", function () {\n            testFile = \"test.css\";\n\n            it(\"Should show linear gradient preview for those with vendor prefix\",async function () {\n                var expectedGradient1 = \"-webkit-linear-gradient(top,  #d2dfed 0%, #c8d7eb 26%, #bed0ea 51%, #a6c0e3 51%, #afc7e8 62%, #bad0ef 75%, #99b5db 88%, #799bc8 100%)\",\n                    expectedGradient2 = \"-webkit-gradient(linear, left top, left bottom, color-stop(0%,#d2dfed), color-stop(26%,#c8d7eb), color-stop(51%,#bed0ea), color-stop(51%,#a6c0e3), color-stop(62%,#afc7e8), color-stop(75%,#bad0ef), color-stop(88%,#99b5db), color-stop(100%,#799bc8))\",\n                    expectedGradient3 = \"-webkit-linear-gradient(top,  #d2dfed 0%,#c8d7eb 26%,#bed0ea 51%,#a6c0e3 51%,#afc7e8 62%,#bad0ef 75%,#99b5db 88%,#799bc8 100%)\",\n                    expectedGradient4 = \"-webkit-gradient(linear, left top, left bottom, from(rgb(51,51,51)), to(rgb(204,204,204)))\";\n                await checkGradientAtPos(expectedGradient1, 80, 36);   // -moz- prefix gets stripped\n                await checkGradientAtPos(expectedGradient2, 81, 36);   // Old webkit syntax\n                await checkGradientAtPos(expectedGradient3, 82, 36);   // -webkit- prefix gets stripped\n                await checkGradientAtPos(expectedGradient3, 83, 36);   // -o- prefix gets stripped\n                await checkGradientAtPos(expectedGradient3, 84, 36);   // -ms- prefix gets stripped\n                await checkGradientAtPos(expectedGradient4, 90, 36);   // test parameters with 2 levels of nested parens\n            });\n\n            it(\"Should show linear gradient preview for those with colon or space before\",async function () {\n                var expectedGradient = \"linear-gradient(to bottom, black 0%, white 100%)\";\n                await checkGradientAtPos(expectedGradient, 169, 25);   // space colon space\n                await checkGradientAtPos(expectedGradient, 170, 25);   // colon space\n                await checkGradientAtPos(expectedGradient, 171, 25);   // space colon\n                await checkGradientAtPos(expectedGradient, 172, 25);   // colon\n            });\n\n            it(\"Should show radial gradient preview for those with colon or space before\",async function () {\n                var expectedGradient = \"radial-gradient(red, white 50%, blue 100%)\";\n                await checkGradientAtPos(expectedGradient, 176, 25);   // space colon space\n                await checkGradientAtPos(expectedGradient, 177, 25);   // colon space\n                await checkGradientAtPos(expectedGradient, 178, 25);   // space colon\n                await checkGradientAtPos(expectedGradient, 179, 25);   // colon\n            });\n\n            it(\"Should show linear gradient preview for those with w3c standard syntax (no prefix)\",async function () {\n                await checkGradientAtPos(\"linear-gradient(#333, #CCC)\",                  99, 50);\n                await checkGradientAtPos(\"linear-gradient(135deg, #333, #CCC)\",          101, 50);\n\n                await checkGradientAtPos(\"linear-gradient(to right, #333, #CCC)\",        98, 50);\n                await checkGradientAtPos(\"linear-gradient(to bottom right, #333, #CCC)\", 100, 50);\n\n\n                // multiple colors\n                await checkGradientAtPos(\"linear-gradient(#333, #CCC, #333)\",             104, 50);\n                await checkGradientAtPos(\"linear-gradient(#333 0%, #CCC 33%, #333 100%)\", 105, 50);\n                await checkGradientAtPos(\"linear-gradient(yellow, blue 20%, #0f0)\",       106, 50);\n            });\n\n            it(\"Should show radial gradient preview for those with vendor prefix syntax\", async function () {\n                var expectedGradient1 = \"-webkit-gradient(radial, center center, 0, center center, 141, from(black), to(white), color-stop(25%, blue), color-stop(40%, green), color-stop(60%, red), color-stop(80%, purple))\",\n                    expectedGradient2 = \"-webkit-radial-gradient(center center, circle contain, black 0%, blue 25%, green 40%, red 60%, purple 80%, white 100%)\";\n                await checkGradientAtPos(expectedGradient1, 110, 93);   // old webkit syntax\n                await checkGradientAtPos(expectedGradient2, 111, 36);   // -webkit- prefix preserved\n                await checkGradientAtPos(expectedGradient2, 112, 36);   // -moz- prefix gets stripped\n                await checkGradientAtPos(expectedGradient2, 113, 36);   // -ms- prefix gets stripped\n                await checkGradientAtPos(expectedGradient2, 114, 36);   // -0- prefix gets stripped\n            });\n\n            it(\"Should show radial gradient preview for those with w3c standard syntax (no prefix)\", async function () {\n                await checkGradientAtPos(\"radial-gradient(yellow, green)\", 118, 35);\n                await checkGradientAtPos(\"radial-gradient(yellow, green)\", 118, 40);\n            });\n\n            it(\"Should show repeating linear gradient preview\",async function () {\n                await checkGradientAtPos(\"repeating-linear-gradient(red, blue 50%, red 100%)\", 122, 50);\n                await checkGradientAtPos(\"repeating-linear-gradient(red 0%, white 0%, blue 0%)\", 123, 50);\n                await checkGradientAtPos(\"repeating-linear-gradient(red 0%, white 50%, blue 100%)\", 124, 50);\n            });\n\n            it(\"Should show repeating radial gradient preview\", async function () {\n                await checkGradientAtPos(\"repeating-radial-gradient(circle closest-side at 20px 30px, red, yellow, green 100%, yellow 150%, red 200%)\", 128, 40);\n                await checkGradientAtPos(\"repeating-radial-gradient(red, blue 50%, red 100%)\", 129, 40);\n            });\n\n            it(\"Should show comma-separated gradients\",async function () {\n                // line ending in comma\n                await checkGradientAtPos(\"linear-gradient(63deg, #999 23%, transparent 23%)\", 135,  50);\n\n                // multiple gradients on a line\n                await checkGradientAtPos(\"linear-gradient(63deg, transparent 74%, #999 78%)\", 136,  50);\n                await checkGradientAtPos(\"linear-gradient(63deg, transparent 0%, #999 38%, #999 58%, transparent 100%)\",   136, 100);\n            });\n\n            it(\"Should convert gradients arguments from pixel to percent\",async function () {\n                // linear gradient in px\n                await checkGradientAtPos(\"-webkit-linear-gradient(top, rgba(0,0,0,0) 0%, green 50%, red 100%)\", 163, 40);\n                // repeating linear-gradient in pixels (no prefix)\n                await checkGradientAtPos(\"repeating-linear-gradient(red, blue 50%, red 100%)\", 164, 40);\n                // repeating radial-gradient in pixels (no prefix)\n                await checkGradientAtPos(\"repeating-radial-gradient(red, blue 50%, red 100%)\", 165, 40);\n            });\n\n            it(\"Should not go into infinite loop on unbalanced parens\", async function () {\n                // no preview, and no infinite loop\n                await expectNoPreviewAtPos(189, 30);\n                await expectNoPreviewAtPos(190, 40);\n            });\n        });\n\n        describe(\"Quick view images\", function () {\n            it(\"Should show image preview for file path inside url()\",async function () {\n                await checkImagePathAtPos(\"img/grabber_color-well.png\", 140, 26);\n                await checkImagePathAtPos(\"img/Color.png\",              141, 26);\n                await checkImagePathAtPos(\"img/throbber.gif\",           142, 26);\n                await checkImagePathAtPos(\"img/update_large_icon.svg\",  143, 26);\n            });\n\n            it(\"Should show image preview for urls with http/https\",async function () {\n                await checkImagePathAtPos(\"https://raw.github.com/gruehle/HoverPreview/master/screenshots/Image.png\", 145, 26);\n            });\n\n            it(\"Should show image preview for file path inside single or double quotes\",async function () {\n                await checkImagePathAtPos(\"img/update_large_icon.svg\",  147, 26);\n                await checkImagePathAtPos(\"img/Color.png\",  148, 26);\n                await checkImagePathAtPos(\"img/throbber.gif\", 149, 26);\n            });\n\n            it(\"Should show image preview for subsequent images in a line\",async function () {\n                await checkImagePathAtPos(\"img/Color.png\", 153, 70);    // url(\"\")\n                await checkImagePathAtPos(\"img/Color.png\", 154, 70);    // url()\n                await checkImagePathAtPos(\"img/Color.png\", 155, 70);    // \"\"\n            });\n\n            it(\"Should show image preview for URIs containing quotes\",async function () {\n                await checkImagePathAtPos(\"img/don't.png\", 183, 26);  // url() containing '\n                await checkImagePathAtPos(\"img/don't.png\", 184, 26);  // url(\"\") containing '\n                await checkImageDataAtPos(\"data:image/svg+xml;utf8, <svg version='1.1' xmlns='http://www.w3.org/2000/svg'></svg>\", 185, 26);  // data url(\"\") containing '\n            });\n\n            it(\"Should show image preview for URLs with known image extensions\",async function () {\n                await checkImageDataAtPos(\"http://example.com/image.gif\", 194, 20);\n                await checkImageDataAtPos(\"http://example.com/image.png\", 195, 20);\n                await checkImageDataAtPos(\"http://example.com/image.jpe\", 196, 20);\n                await checkImageDataAtPos(\"http://example.com/image.jpeg\", 197, 20);\n                await checkImageDataAtPos(\"http://example.com/image.jpg\", 198, 20);\n                await checkImageDataAtPos(\"http://example.com/image.ico\", 199, 20);\n                await checkImageDataAtPos(\"http://example.com/image.bmp\", 200, 20);\n                await checkImageDataAtPos(\"http://example.com/image.svg\", 201, 20);\n            });\n\n            it(\"Should show image preview for extensionless URLs (with protocol) with pref set\",async function () {\n                // Flip the pref on and restore when done\n                var original = prefs.get(\"extensionlessImagePreview\");\n                prefs.set(\"extensionlessImagePreview\", true);\n\n                await checkImageDataAtPos(\"https://image.service.com/id/1234513\", 203, 20); // https\n                await checkImageDataAtPos(\"http://image.service.com/id/1234513\", 204, 20);  // http\n                await checkImageDataAtPos(\"https://image.service.com/id/1234513?w=300&h=400\", 205, 20); // qs params\n\n                prefs.set(\"extensionlessImagePreview\", original);\n            });\n\n            it(\"Should not show image preview for extensionless URLs (with protocol) without pref set\", async function () {\n                // Flip the pref off and restore when done\n                var original = prefs.get(\"extensionlessImagePreview\");\n                prefs.set(\"extensionlessImagePreview\", false);\n\n                await checkImageDataAtPos(\"https://image.service.com/id/1234513\", 203, 20); // https\n                await checkImageDataAtPos(\"http://image.service.com/id/1234513\", 204, 20);  // http\n                await checkImageDataAtPos(\"https://image.service.com/id/1234513?w=300&h=400\", 205, 20); // qs params\n\n                prefs.set(\"extensionlessImagePreview\", original);\n            });\n\n            it(\"Should ignore URLs for common non-image extensions\", async function () {\n                await expectNoPreviewAtPos(209, 20); // .html\n                await expectNoPreviewAtPos(210, 20); // .css\n                await expectNoPreviewAtPos(211, 20); // .js\n                await expectNoPreviewAtPos(212, 20); // .json\n                await expectNoPreviewAtPos(213, 20); // .md\n                await expectNoPreviewAtPos(214, 20); // .xml\n                await expectNoPreviewAtPos(215, 20); // .mp3\n                await expectNoPreviewAtPos(216, 20); // .ogv\n                await expectNoPreviewAtPos(217, 20); // .mp4\n                await expectNoPreviewAtPos(218, 20); // .mpeg\n                await expectNoPreviewAtPos(219, 20); // .webm\n                await expectNoPreviewAtPos(220, 20); // .zip\n                await expectNoPreviewAtPos(221, 20); // .tgz\n            });\n\n            it(\"Should show image preview for a data URI inside url()\", async function () {\n                await checkImageDataAtPos(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABq0lEQVQoU11RPUgcURD+Zt/unnrcCf4QIugRMcS7a2xjmmArRlRIFRBFgrVtGgmBRFCwTBoLsQiBGMxiJ4iksLRSFEzQRC2EAwm5g727feP3LpyFy1tm5s33zcz7RnDvG4x0zFgMJRY/jiewhy/w8FKSJkyaTuG7Fumvi+ARbQiLpcMDvH/Qj1S6Bf6vI5SxKPUG4fGm5kMf6wr08MKHILCKldoZlk0OIeuHjNuDBBcNAqvvENTLwKii1ZFoF/7G2PQDpNo8dFUt1AcSGfymz42PVfI8ghxht1bHh9MpucCiegMFdJoUOtSD+MxLPtI5T/GaHWhg+NjRk3G5utPikwb5bjzhq40JSChs6Sx1eOYAojg/fCFv7yvnBLGCLPMqxS2dZrtXnDthhySuYebnpFw3ST2RtmUVIx5z1sIKdX9qgDcOTJAj7WsNa8eTUhrY0Gwqg2FldeZiduH5r9JHvqEDigzDS/4VJvYJfMh9VLmbNO9+s9hNg5D/qjkJ8I6uW0yFtkrwHydCg+AhVgsp/8Pnu00XI+0jYJ7gjANRiEsmQ3aNOXuJhG035i1QA6g+uONCrgAAAABJRU5ErkJggg==\",  159, 26);\n            });\n        });\n    });\n});\n"],"file":"unittests.js"}