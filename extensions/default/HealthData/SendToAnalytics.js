define(function(require,exports,module){const Metrics=brackets.getModule("utils/Metrics"),PreferencesManager=brackets.getModule("preferences/PreferencesManager"),PerfUtils=brackets.getModule("utils/PerfUtils"),themesPref=PreferencesManager.getExtensionPrefs("themes"),PLATFORM=Metrics.EVENT_TYPE.PLATFORM,PERFORMANCE=Metrics.EVENT_TYPE.PERFORMANCE,STORAGE=Metrics.EVENT_TYPE.STORAGE;function _emitDeviceTypeMetrics(){brackets.browser.isDeskTop&&Metrics.countEvent(PLATFORM,"device","desktop"),brackets.browser.isMobile&&Metrics.countEvent(PLATFORM,"device","mobile"),brackets.browser.isTablet&&Metrics.countEvent(PLATFORM,"device","tablet")}function _emitMobileMetricsIfPresent(){let platform="none";if(brackets.browser.mobile.isIos)platform="ios";else if(brackets.browser.mobile.isWindows)platform="windows";else{if(!brackets.browser.mobile.isAndroid)return;platform="android"}Metrics.countEvent(PLATFORM,"mobile",platform)}function _emitBrowserMetrics(){brackets.browser.desktop.isChrome&&Metrics.countEvent(PLATFORM,"browser","chrome"),brackets.browser.desktop.isChromeBased&&Metrics.countEvent(PLATFORM,"browser","chromeBased"),brackets.browser.desktop.isEdgeChromium&&Metrics.countEvent(PLATFORM,"browser","EdgeChromium"),brackets.browser.desktop.isFirefox&&Metrics.countEvent(PLATFORM,"browser","firefox"),brackets.browser.desktop.isOpera&&Metrics.countEvent(PLATFORM,"browser","opera"),brackets.browser.desktop.isOperaChromium&&Metrics.countEvent(PLATFORM,"browser","operaChromium")}async function _sendStorageMetrics(){if(navigator.storage&&navigator.storage.estimate){const quota=await navigator.storage.estimate(),percentageUsed=Math.round(quota.usage/quota.quota*100),usedMB=Math.round(quota.usage/1024/1024);console.log(`Web Storage quota used: ${percentageUsed}%, ${usedMB}MB`),Metrics.valueEvent(STORAGE,"browserQuota","percentUsed",percentageUsed),Metrics.valueEvent(STORAGE,"browserQuota","usedMB",usedMB)}}function sendPlatformMetrics(){Metrics.countEvent(PLATFORM,"os",brackets.platform),Metrics.countEvent(PLATFORM,"os.flavor",brackets.getPlatformInfo()),Metrics.countEvent(PLATFORM,"userAgent",window.navigator.userAgent),Metrics.countEvent(PLATFORM,"languageOS",brackets.app.language),Metrics.countEvent(PLATFORM,"languageBrackets",brackets.getLocale()),Metrics.countEvent(PLATFORM,"bracketsVersion",brackets.metadata.version),_emitDeviceTypeMetrics(),_emitBrowserMetrics(),_emitMobileMetricsIfPresent(),_sendStorageMetrics()}function sendStartupPerformanceMetrics(){const healthReport=PerfUtils.getHealthReport();Metrics.valueEvent(PERFORMANCE,"startup","AppStartupTime",Number(healthReport.AppStartupTime)),Metrics.valueEvent(PERFORMANCE,"startup","ModuleDepsResolved",Number(healthReport.ModuleDepsResolved))}function _getCurrentTheme(){return themesPref.get("theme")||"default"}function sendThemesMetrics(){Metrics.countEvent(Metrics.EVENT_TYPE.THEMES,"currentTheme",_getCurrentTheme())}exports.sendPlatformMetrics=sendPlatformMetrics,exports.sendStartupPerformanceMetrics=sendStartupPerformanceMetrics,exports.sendThemesMetrics=sendThemesMetrics});
//# sourceMappingURL=SendToAnalytics.js.map
